/*! For license information please see deferred.js.LICENSE.txt */
(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred"],{121:function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"r",function(){return c}),n.d(t,"i",function(){return d});var a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},a(e,t)};function i(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var r=function(){return r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};function o(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})}function s(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}function c(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],a=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function d(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,i++)a[i]=r[o];return a}},216:function(e,t,n){"use strict";var a=n(93);n.d(t,"e",function(){return a.n})},274:function(e,t,n){"use strict";n.d(t,"o",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"n",function(){return s}),n.d(t,"s",function(){return c}),n.d(t,"t",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"i",function(){return u});var a=n(368),i=n(348);n.d(t,"r",function(){return i.e}),new a.t("provider.suiteNav"),new a.t("provider.peopleCard"),new a.t("provider.shareByLink"),new a.t("provider.groupsLeftNav"),new a.t("provider.publishingSiteProvider"),new a.t("provider.userInfo");var r=new a.t("provider.tag"),o=new a.t("provider.photo"),s=(new a.t("provider.notification"),new a.t("provider.notificationManager"),new a.t("provider.instrumentation")),c=new a.t("provider.teachingBubble"),d=(new a.t("provider.feedback"),new a.t("provider.embed")),l=(new a.t("provider.storageInfo"),new a.t("provider.storageOptions"),new a.t("provider.subscriptions"),new a.t("provider.customAction"),new a.t("provider.taxonomy"),new a.t("provider.thumbnail"),new a.t("provider.appsItem"),new a.t("provider.externallySharedItem"),new a.t("provider.popularItem"),new a.t("provider.mostViewsItem"),new a.t("provider.mostViewersItem"),new a.t("provider.subsiteItem"),new a.t("provider.itemHistory"),new a.t("provider.spotlight"),new a.t("provider.error"),new a.t("provider.publish"),new a.t("provider.bundleLoader")),u=(new a.t("provider.upsell"),new a.t("provider.profile"),new a.t("provider.processFilters"),new a.t("provider.userState"));new a.t("provider.ransomwareDetection"),new a.t("provider.promotedPhotos"),new a.t("provider.site"),new a.t("provider.graphToken"),new a.t("provider.dragAndDropRobot"),new a.t("provider.recycleBin"),new a.t("provider.premiumState"),new a.t("provider.mruRecent"),new a.t("provider.userExpiration"),new a.t("provider.requestReview")},282:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(21),i=n(196),r=n(268),o=n(368),s=n(486),c=n(635),d=n(378),l="Engagement",u=new o.t({name:"".concat(l,".useEngagementSystem"),factory:new o.e(!0)}),f={engagementHandlers:d.e.optional},p=new o.t({name:"".concat(l,".engagementHelper"),loader:{load:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,Promise.all([n.e("deferred.resx-deferred"),n.e("deferred.odsp-datasources"),n.e("deferred.odsp-common"),n.e("deferred")]).then(n.bind(null,1490))];case 1:return e=t.sent().EngagementHelper,[2,{dependencies:f,create:function(t){var n=t.engagementHandlers;return{instance:new e({},{handlers:n})}}}]}})})}}}),m=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._isEnabled=n.isEnabled,a._getEngagementHelper=n.getEngagementHelper,a._getEngagementHandlers=n.getEngagementHandlers,a._isEnabled&&a._getEngagementHelper().catch(function(){}),a}return Object(a.__extends)(t,e),t.prototype.logData=function(e){var t=this;void 0===e&&(e={}),this._isEnabled?this._getEngagementHelper().then(function(n){n.fromSource({contexts:t.contexts}).logData(e)}).catch(function(){}):e.name&&r.e.logData(e)},t.prototype.clone=function(e){return new t({},{engagementSource:{contexts:e},isEnabled:this._isEnabled,getEngagementHelper:this._getEngagementHelper,getEngagementHandlers:this._getEngagementHandlers})},t.dependencies={engagementSource:c.n,isEnabled:u,getEngagementHelper:p.async.lazy,getEngagementHandlers:d.e.optional.async.lazy},t}(i.t),_=Object(s.r)(l,m)},348:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(368).t)("provider.suiteNavBasic")},449:function(e,t,n){"use strict";n.r(t),n.d(t,"getProperties",function(){return r}),n.d(t,"createSearchRoot",function(){return o}),n.d(t,"getItemStatistics",function(){return s}),n.d(t,"getUserFromOwsString",function(){return c});var a=n(176),i=n(77);function r(e){for(var t={},n=0,a=e.results;n<a.length;n++){var i=a[n],r=i.Key,o=i.Value;switch(i.ValueType){case"Edm.Boolean":t[r]={false:!1,true:!0}[o];break;case"Edm.Double":t[r]=parseFloat(o);break;case"Edm.Byte":case"Edm.Int32":case"Edm.Int64":t[r]=parseInt(o,10);break;case"Null":t[r]=null;break;case"Edm.String":if("Edges"===r){for(var s=JSON.parse(o),c=0,d=s;c<d.length;c++){var l=d[c];l.Properties.BlobContent&&(l.Properties.BlobContent=JSON.parse(l.Properties.BlobContent.toString()))}t[r]=s}else t[r]=o;break;default:t[r]=o}}return t}function o(e){var t=new a.e(e.key);return t.type=i.e.Folder,t.queryType=t.displayType=e.queryType,t.name=t.displayName=e.name,t.isRootFolder=!0,e.isPlaceholder||(t.isPlaceholder=!1),"number"==typeof e.childCount&&(t.folder={childCount:e.childCount}),t}function s(e){return{views:e.ViewsLifeTime||0,viewsUnique:e.ViewsLifeTimeUniqueUsers||0,viewsLast2Weeks:e.ViewsRecent||0,viewsLast2WeeksUnique:e.ViewsRecentUniqueUsers||0,viewsLastMonth:e.ViewsLastMonths1||0,viewsLastMonthUnique:e.ViewsLastMonths1Unique||0,viewsLastWeek:(e.ViewsLast7Days||0)+(e.ViewsLast6Days||0)+(e.ViewsLast5Days||0)+(e.ViewsLast4Days||0)+(e.ViewsLast3Days||0)+(e.ViewsLast2Days||0)+(e.ViewsLast1Days||0),viewsLastWeekUnique:(e.ViewsLast7DaysUniqueUsers||0)+(e.ViewsLast6DaysUniqueUsers||0)+(e.ViewsLast5DaysUniqueUsers||0)+(e.ViewsLast4DaysUniqueUsers||0)+(e.ViewsLast3DaysUniqueUsers||0)+(e.ViewsLast2DaysUniqueUsers||0)+(e.ViewsLast1DaysUniqueUsers||0)}}function c(e){var t={title:"",email:"",id:"",sip:""};if(e){var n=e.indexOf("|");t.sip=e.slice(0,n).trim();var a=e.indexOf("|",n+1);t.title=e.slice(n+1,a).trim()}return t}},591:function(e,t,n){"use strict";var a=n(21),i=n(42),r=function(e){function t(t,n){return e.call(this,t,n)||this}return Object(a.__extends)(t,e),t}(function(){function e(e,t){this.value=e,this.extraClasses=t}return e.prototype.getClass=function(){var e=this.value?Object(i.x)(this.value):void 0;return"ms-Icon ms-Icon--".concat(this.value," ").concat(e||"").concat(this.extraClasses?" "+this.extraClasses:"")},e.prototype.getExtraClasses=function(){return this.extraClasses},e.prototype.toString=function(){return this.value},e}());t.e=r},601:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(368).t)("searchBoxConfig")},617:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(368).t)("suiteNavV2")},619:function(e,t,n){"use strict";n.d(t,"t",function(){return l}),n.d(t,"e",function(){return u});var a=n(368),i=n(376),r=new(n(123).e)("photosExperimentHelperKeyFacet",{}).serialize({}),o=new(n(51).e)("photosExperimentHelper"),s=n(5);n(57),n(109);var c=n(6),d=n(102),l=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabled"),factory:{dependencies:{},create:function(e){return{instance:c.mo?Object(c.uo)(c.xr)||Object(c.uo)(c.Mr):Object(c.uo)(c.Tr)}}}}),u=(new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInFilesPivot"),factory:{dependencies:{},create:function(){return{instance:c.mo?Object(c.uo)(c.xr):Object(c.uo)(c.Tr)}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInRecentPivot"),factory:{dependencies:{},create:function(){return{instance:Object(c.uo)(c.rt)}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSharedPivot"),factory:{dependencies:{},create:function(){return{instance:Object(c.uo)(c.Er)}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInCrossSitePivots"),factory:{dependencies:{},create:function(){return{instance:!!c.mo&&Object(c.uo)(c.Mr)}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPhotosPivot"),factory:{dependencies:{platformDetection:d.e},create:function(e){return{instance:Object(c.uo)(c._r)&&(!e.platformDetection.isIE||Object(c.uo)(c.hr))&&(!e.platformDetection.isSafari||Object(c.uo)(c.vr))&&(!e.platformDetection.isMobile||Object(c.uo)(c.gr))}}}})),f=(new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSingleAlbumView"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(c.uo)(c.Ar)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSingleTagView"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(c.uo)(c.kr)&&e.isItemsScopeEnabledInAllPhotosPivot}}}})),p=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSinglePlace"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(c.uo)(c.Lr)&&e.isItemsScopeEnabledInAllPhotosPivot}}}});new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPhotosFilePicker"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(c.uo)(c.br)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllTagsPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(c.uo)(c.yr)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPlacesPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(c.uo)(c.Cr)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllAlbumsPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(c.uo)(c.mr)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInAllPhotosPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:function(e){var t=e(Object(i.e)(function(e){return e.demandItemFacet(o,r)}));return Object(s.isFeatureEnabled)(s.UseVroomInItemsScopeAllPhotos)||Boolean(t&&t.isUseVroomInItemsScopeAllPhotosOtdExpOn())}&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInSingleTagView"),factory:{dependencies:{isItemsScopeEnabledInSingleTagView:f},create:function(e){return{instance:Object(c.uo)(c.io)&&e.isItemsScopeEnabledInSingleTagView}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInSinglePlaceView"),factory:{dependencies:{isItemsScopeEnabledInSinglePlaceView:p},create:function(e){return{instance:Object(c.uo)(c.ao)&&e.isItemsScopeEnabledInSinglePlaceView}}}})},635:function(e,t,n){"use strict";n.d(t,"n",function(){return r});var a=n(196);n.d(t,"e",function(){return a.n});var i=n(368);n.d(t,"t",function(){return a.a});var r=new i.t({name:"".concat("Engagement",".engagementSource"),factory:new i.e(a.e)})},646:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(368).t)("prefetchCache")},684:function(e,t,n){"use strict";var a=n(601);n.d(t,"e",function(){return a.e})},706:function(e,t,n){"use strict";n.r(t),n.d(t,"previewImageUrl",function(){return i}),n.d(t,"previewImageUrlFromProps",function(){return r}),n.d(t,"previewImageUrlFromUrl",function(){return o});var a=n(1150);function i(e,t,n,a){if(n.isSPO){var i=e.SiteId||e.SiteID||e.siteId||n.siteId,s=e.WebId||e.webId||n.webId,c=e.UniqueId||e.UniqueID||e.uniqueId,d=e.Url||e.url||e.Path;return c&&i&&s&&!a?r(i,s,c,t,n):o(d,t,n)}}function r(e,t,n,a,i){var r;if(i.isSPO)return n&&(r=s(function(r){var o=r?"":"&resolution=Width1024";return a+"/"+i.layoutsUrl+"/getpreview.ashx?clientType=docLibGrid&guidFile="+n+"&guidSite="+e+"&guidWeb="+t+o})),r}function o(e,t,n){var a;if(n.isSPO)return e&&(a=s(function(a){var i=a?"":"&resolution=Width1024";return t+"/"+n.layoutsUrl+"/getpreview.ashx?clientType=docLibGrid&path="+e+i})),a}function s(e){return{url:e(!0),width:0,height:0,getAligned:function(t,n){return{url:e(n.name===a.e.name),width:0,height:0}}}}},707:function(e,t,n){"use strict";n.d(t,"t",function(){return v}),n.d(t,"n",function(){return y});var a,i,r,o,s,c=n(540),d=(n(591),n(708)),l=n(341);n.d(t,"e",function(){return l.e});var u="ms-word",f="onenote|UsePlain",p="ms-powerpoint",m="ms-excel",_="ms-visio",h="ms-publisher",b="ms-project";(a={})[u]=d.f,a[f]=d.i,a[p]=d.o,a[m]=d.t,a[_]=d.l,(i={})[u]=d.u,i[f]=d.a,i[p]=d.r,i[m]=d.e,i[_]=d.d,i[h]=d.c,i[b]=d.s,i["ms-infopath"]=d.n;var g=((r={})[u]="Word",r[f]="OneNote",r[p]="PowerPoint",r[b]="Project",r[_]="Visio",r[m]="Excel",r);function v(e){var t=e.extension;return t&&".pdf"===t.toLowerCase()?"WordPdf":g[e.appMap]||"Word"}function y(e){var t=c.e;return-1!==t["ms-word"].lastIndexOf(e)?"ms-word":-1!==t["ms-powerpoint"].lastIndexOf(e)?"ms-powerpoint":-1!==t["ms-excel"].lastIndexOf(e)?"ms-excel":-1!==t["ms-visio"].lastIndexOf(e)?"ms-visio":-1!==t["onenote|UsePlain"].lastIndexOf(e)?"onenote|UsePlain":-1!==t["ms-access"].lastIndexOf(e)?"ms-access":-1!==t["ms-project"].lastIndexOf(e)?"ms-project":-1!==t["ms-publisher"].lastIndexOf(e)?"ms-publisher":void 0}(o={})[u]="WordLogo",o[f]="OneNoteLogo",o[p]="PowerPointLogo",o[m]="ExcelLogo",o[_]="VisioLogo",o[h]="Page",(s={})[u]="svg/word_16x1.svg",s[f]="svg/onenote_16x1.svg",s[p]="svg/powerpoint_16x1.svg",s[m]="svg/excel_16x1.svg",s[_]="svg/visio_16x1.svg",s[h]="Page",s.Stream="svg/stream_16x1.svg"},709:function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"t",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"n",function(){return d}),n.d(t,"i",function(){return l}),n.d(t,"r",function(){return u});var a=n(278),i=n(955),r=n(66);function o(e){return e?r.format(a.A,e):""}function s(e){var t=e&&e[e.length-1];return t?t.title||t.Title:""}function c(e){var t=e&&e[e.length-1];return{title:t&&t.title,email:t&&t.email,picture:t&&Object(i.e)({userLoginName:t.email})}}function d(e){return e?e.substr(e.lastIndexOf("\n")+1):""}function l(e){if(!e)return"";try{var t=window.DOMParser,n=t&&(new t).parseFromString(e,"text/html");return n&&n.body&&n.body.innerText}catch(e){return""}}function u(e){return e&&"0x0120"===e.slice(0,6)}},849:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return T});var a=n(21),i=n(40),r=n(216),o=n(449),s=n(176),c=n(77),d=n(153),l=n(156),u=n(748),f=n(75),p=n(48),m=n(56),_=n(43),h=n(247),b=n(54),g=n(486),v=n(1256),y=n(278),S=n(44),D=n(254),I=n(160),x=n(100),C=n(201),O=n(111),w=n(119),E=n(46),A=n(6),L="CurrentWebDataSource_CurrentWeb",k="CurrentWebDataSource_SubWebs",M=["Title","Path","Filename","Created","LastModifiedTime","LinkingUrl","ParentLink","SiteID","WebId","UniqueID","ViewsLifeTime","ViewsLifeTimeUniqueUsers","ViewsRecent","ViewsRecentUniqueUsers","ViewsLastMonths1","ViewsLastMonths1Unique","ViewsLast7Days","ViewsLast6Days","ViewsLast5Days","ViewsLast4Days","ViewsLast3Days","ViewsLast2Days","ViewsLast1Days","ViewsLast7DaysUniqueUsers","ViewsLast6DaysUniqueUsers","ViewsLast5DaysUniqueUsers","ViewsLast4DaysUniqueUsers","ViewsLast3DaysUniqueUsers","ViewsLast2DaysUniqueUsers","ViewsLast1DaysUniqueUsers"],P=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._pageContext=n.pageContext,a._itemsStore=n.itemsStore,a._urlDataSourceLite=n.urlDataSourceLite,a._identityDataSource=n.identityDataSource,a._apiUrlHelper=n.apiUrlHelper,a._itemUrlHelper=n.itemUrlHelper,a._dataRequestor=new(a.scope.attached(n.dataRequestorType))({qosName:"CurrentWebDataSource"}),a}return Object(a.__extends)(t,e),t.prototype.getCurrentWeb=function(){var e=this,t=this._itemsStore.getValue(L);if(t)return u.t.wrap(t);var n=this._apiUrlHelper.build().segments("search","query").parameters({querytext:"*",querytemplate:'SiteId:"'.concat(b.e.normalizeLower(this._pageContext.siteId,!1),'" ')+'AND WebId:"'.concat(b.e.normalizeLower(this._pageContext.webId,!1),'" ')+"AND (contentclass:STS_Site OR contentclass:STS_Web)",rowlimit:1,bypassresulttypes:!1,selectproperties:M.join(","),SourceId:"8413cd39-2156-4e00-b54d-11efd9abdb89"});return this._pageContext.groupType===v.e.private&&(n=n.parameter("Properties","EnableDynamicGroups:true")),this._dataRequestor.getData({url:n.toString(),qosName:"GetCurrentWeb",method:"POST"}).then(function(t){if(t&&t.d){var n=e._processData(t);for(var a in n)return e._itemsStore.setValue(L,n[a]),n[a]}return null})},t.prototype.getSubWebs=function(){var e=this,t=this._itemsStore.getValue(k);if(t)return u.t.wrap(t);var n=this._pageContext.webAbsoluteUrl,a=this._apiUrlHelper.build().segments("search","query").parameters({querytext:"*",querytemplate:'ParentLink:"'.concat(n,'" AND contentclass:STS_Web'),rowlimit:100,bypassresulttypes:!1,selectproperties:M.join(",")});return this._dataRequestor.getData({url:a.toString(),qosName:"GetSubWebs",method:"GET"}).then(function(t){if(t&&t.d){var n=e._processData(t);return e._itemsStore.setValue(k,n),n}return null})},t.prototype.getMyOneDriveUrl=function(){var e;if(Number(this._pageContext.webTemplate)===w.t.mySite&&(Object(A.uo)(A.La)?this._pageContext.isMySiteOwner:this._pageContext.isSiteOwner))e=u.t.resolve(this._pageContext.webAbsoluteUrl);else{if(this._pageContext.isAnonymousGuestUser||this._pageContext.isEmailAuthenticationGuestUser||this._pageContext.isExternalGuestUser)return u.t.resolve(void 0);var t=this._apiUrlHelper.build().segments("SP.Directory.DirectorySession","me").rawParameter("$select=mySite");e=this._dataRequestor.getData({url:t.toString(),qosName:"GetMyOneDriveUrl",noRedirect:!0,method:"POST"}).then(function(e){if(e&&e.d){var t=e.d.mySite;return t&&t.replace(/\/$/,"")}})}return this.getMyOneDriveUrl=function(){return e},e},t.prototype.getDefaultOneDriveLibrary=function(e){var t=this._apiUrlHelper.build().method("SP.Web.DefaultDocumentLibraryUrl",e);return this._dataRequestor.getData({url:t.toString(),qosName:"GetDefaultDocumentLibrary"}).then(function(t){var n=t&&t.d&&t.d.DefaultDocumentLibraryUrl;if(n){var a=[],i=new p.t(e),r={title:y.c,target:n.ServerRelativeUrl,customSettingsUrl:i.getScheme()+"://"+i.getHost()+n.ServerRelativeUrl,remote:n.FromCrossFarm};return a.push(r),a}return null})},t.prototype.getLists=function(e,t){var n=this,a=new D.e(e);return this._getTokenIfNecessary(e).then(function(t){var a;return a=t?new I.t({webAbsoluteUrl:e}).build().segment("Web").segment("AppTiles"):n._apiUrlHelper.build().method("SP.RemoteWeb",e).segment("Web").segment("AppTiles"),n._dataRequestor.getData({url:a.toString(),qosName:"GetLists",noRedirect:!0,authToken:t})}).then(function(e){return e&&e.d?e.d.results.filter(function(e){return t?(1===e.AppType||5===e.AppType||0===e.AppType)&&n._isSupportedBaseTemplate(e.BaseTemplate,!0):(1===e.AppType||5===e.AppType)&&n._isSupportedBaseTemplate(e.BaseTemplate)}).map(function(e){return{title:e.Title,thumbnail:e.Thumbnail,lastModified:e.LastModified,appType:e.AppType,appStatus:e.AppStatus,target:a.authority+e.Target,childCount:e.ChildCount,appId:e.AppId,appSource:e.AppSource,assetId:e.AssetId,productId:e.ProductId,contentMarket:e.ContentMarket,customSettingsUrl:e.CustomSettingsUrl,baseTemplate:e.BaseTemplate,appPrincipalId:e.AppPrincipalId}}):null})},t.prototype.getDocumentLibraries=function(e,t){var n=this;void 0===t&&(t={});var a=t.includeMediaLibraries,i=void 0!==a&&a,r=t.includePageLibraries,o=void 0!==r&&r,s=i?"GetDocumentAndMediaLibraries":"GetDocumentLibraries",c=this._apiUrlHelper.build().segment("SP.Web.".concat(s)).parameter("webFullUrl",e);return i&&(c=c.parameter("includePageLibraries",o.toString())),this._dataRequestor.getData({url:c.toString(),qosName:"GetDocumentLibraries",noRedirect:!0}).then(function(e){return e&&e.d?n._processDocLibData(e,s):null})},t.prototype.doesListWithTitleExist=function(e,t,n){var a=this,i=n||this._pageContext.webAbsoluteUrl;return this._getTokenIfNecessary(i).then(function(n){var r;return r=n?new I.t({webAbsoluteUrl:i}).build().segment("web").segment("lists").method("GetByTitle",e):a._apiUrlHelper.build().method("SP.RemoteWeb",i).segment("web").segment("lists").method("GetByTitle",e),a._dataRequestor.getData({url:r.toString(),qosName:"GetListByTitle",noRedirect:!0,additionalHeaders:t,authToken:n}).then(function(){return!0},function(){return!1})})},t.prototype.deleteList=function(e,t,n){var i=this,r=Object(a.__assign)({"X-HTTP-Method":"DELETE","If-Match":"*"},n),o=t||this._pageContext.webAbsoluteUrl;return this._getTokenIfNecessary(o).then(function(t){var n;return n=t?new I.t({webAbsoluteUrl:o}).build().segment("web").segment("lists").method("GetByTitle",e):i._apiUrlHelper.build().method("SP.RemoteWeb",o).segment("web").segment("lists").method("GetByTitle",e),i._dataRequestor.getData({url:n.toString(),qosName:"DeleteListByTitle",noRedirect:!0,additionalHeaders:r,authToken:t})})},t.prototype.recycleListById=function(e,t,n){var a=this,i=n||this._pageContext.webAbsoluteUrl;return this._getTokenIfNecessary(i).then(function(n){var r;return r=n?new I.t({webAbsoluteUrl:i}).build().segment("web").method("lists",e).segment("recycle"):a._apiUrlHelper.build().method("SP.RemoteWeb",i).segment("web").method("lists",e).segment("recycle"),a._dataRequestor.getData({url:r.toString(),qosName:"RecycleListById",noRedirect:!0,additionalHeaders:t,authToken:n,method:"POST"})})},t.prototype.checkEffectivePermissions=function(e,t,n){var a=this._apiUrlHelper.build().segment("web").method("GetList",e).segment("EffectiveBasePermissions");return this._dataRequestor.getData({url:a.toString(),qosName:"checkEffectivePermissions",noRedirect:!0,additionalHeaders:n}).then(function(e){return O.e.hasItemPermission({permissions:e.d.EffectiveBasePermissions},t)})},t.prototype.checkWebEffectivePermissions=function(e,t,n){var a=this,i=t||this._pageContext.webAbsoluteUrl;return this._getTokenIfNecessary(i).then(function(t){var r;return r=t?new I.t({webAbsoluteUrl:i}).build().segment("web").segment("EffectiveBasePermissions"):a._apiUrlHelper.build().method("SP.RemoteWeb",i).segment("web").segment("EffectiveBasePermissions"),a._dataRequestor.getData({url:r.toString(),qosName:"checkWebEffectivePermissions",noRedirect:!0,additionalHeaders:n,authToken:t}).then(function(t){return O.e.hasItemPermission({permissions:t.d.EffectiveBasePermissions},e)})}).catch(function(){return!1})},t.prototype.ensureSiteAssetsAndPermissions=function(e,t){var n=this._apiUrlHelper.build().segment("web").segment("lists").segment("EnsureSiteAssetsLibrary").rawParameter("$expand=EffectiveBasePermissions");return this._dataRequestor.getData({url:n.toString(),qosName:"EnsureSiteAssetsAndPermissions",noRedirect:!0,additionalHeaders:t}).then(function(t){return O.e.hasItemPermission({permissions:t.d.EffectiveBasePermissions},e)})},t.prototype.getListDefaultViewUrlByTitle=function(e,t){var n=this._apiUrlHelper.build().segment("web").segment("lists").method("GetByTitle",e).segment("DefaultView");return this._dataRequestor.getData({url:n.toString(),qosName:"GetListDefaultViewUrlByTitle",noRedirect:!0,additionalHeaders:t}).then(function(e){return e.d.ServerRelativeUrl})},t.prototype.getListIdByTitle=function(e,t){var n=this._apiUrlHelper.build().segment("web").segment("lists").method("GetByTitle",e);return this._dataRequestor.getData({url:n.toString(),qosName:"GetListIdByTitle",noRedirect:!0,additionalHeaders:t}).then(function(e){return e.d.Id})},t.prototype.makeHomePage=function(e){var t={__metadata:{type:"SP.Folder"},WelcomePage:e},n=this._apiUrlHelper.build().segments("web","RootFolder");return this._dataRequestor.getData({url:n.toString(),qosName:"MakeHomepage",additionalPostData:JSON.stringify(t),method:"POST",additionalHeaders:{"x-http-method":"MERGE"}})},t.prototype.setSchedulingFeature=function(e){var t=e?"add":"remove",n=this._apiUrlHelper.build().segments("web","Features","".concat(t,"(guid'E87CA965-5E07-4A23-B007-DDD4B5AFB9C7')"));return this._dataRequestor.getData({url:n.toString(),qosName:"SchedulingFeature",noRedirect:!0}).then(function(t){return{isFeatureActivated:e}})},t.prototype.listPowerPlatformUserDetails=function(){var e=this,t=this._apiUrlHelper.build().segments("web","ListPowerPlatformUserDetails");return this._dataRequestor.getData({url:t.toString(),qosName:"ListPowerPlatformUserDetails",method:"POST",parseResponse:function(t){return e._processPowerPlatformSyncResult(t)}})},t.prototype.consentToPowerPlatform=function(){var e=this,t=this._apiUrlHelper.build().segments("web","ConsentToPowerPlatform");return this._dataRequestor.getData({url:t.toString(),qosName:"ConsentToPowerPlatform",method:"POST",parseResponse:function(t){return e._processPowerPlatformSyncResult(t)}})},t.prototype._processDocLibData=function(e,t){var n=e.d[t],a=[];return n&&n.results&&(a=n.results.map(function(e){return{title:e.Title,target:e.ServerRelativeUrl,customSettingsUrl:e.AbsoluteUrl,remote:e.FromCrossFarm,id:e.Id}})),a},t.prototype._processData=function(e){for(var t,n={},a=0,i=e.d.query.PrimaryQueryResult.RelevantResults.Table.Rows.results;a<i.length;a++){var r=i[a],d=o.getProperties(r.Cells),u=new p.t(d.Path),m=this._urlDataSourceLite.getKey(((t={})[f.n.idParamKey]=u.getPath(),t[f.n.uniqueParamKey]="search".concat(d.UniqueID||""),t)),_=new s.e(m);_.id=b.e.normalizeUpper(d.WebId,!1),_.name=d.Filename,_.parentLink=d.ParentLink,_.displayName=d.Title,_.isPlaceholder=!1,_.type=c.e.Unknown,_.dateModified=Object(l.t)(new Date(d.LastModifiedTime)),_.openUrl=d.LinkingUrl||d.Path,_.statistics=o.getItemStatistics(d),_.itemFromServer=d,n[_.id]=_}return n},t.prototype._processPowerPlatformSyncResult=function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;try{var n=JSON.parse(e);t.synchronizationDataObject=n.d.SynchronizationData,t.synchronizationStatus=n.d.SynchronizationStatus}catch(e){E.e.logError(e,{eventName:"PowerPlatformResponseParsingFailure",feature:"BizAppsForListTemplates"})}return t},t.prototype._isSupportedBaseTemplate=function(e,t){var n=e===S.t.genericList||e===S.t.survey||e===S.t.links||e===S.t.announcements||e===S.t.contacts||e===S.t.tasks||e===S.t.customGrid||e===S.t.issueTracking;return t?n||e===S.t.documentLibrary:n},t.prototype._getTokenIfNecessary=function(e){return this._itemUrlHelper.getUrlParts({webUrl:e,path:e}).isCrossDomain?this._identityDataSource.getSharePointToken(new D.e(e).authority).then(function(e){return e.accessToken}):u.t.resolve("")},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{pageContext:_.i,itemsStore:d.e,apiUrlHelper:h.e,itemUrlHelper:x.o,dataRequestorType:r.e,urlDataSourceLite:m.y,identityDataSource:C.t}),t}(i.n);t.default=P;var T=Object(g.r)("WebDataSource",P)},869:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(21),i=n(224),r=n(112);function o(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var o,s,c,d;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,e.consumeAsync(i.e.optional)];case 1:return a.sent(),o=e.consume(r.e),s=t(o),c=new(e.injected(s))(n||{}),d=function(){c.dispose()},[4,c.execute(null).done(d,d)];case 2:return a.sent(),[2]}})})}},897:function(e,t,n){"use strict";n.d(t,"e",function(){return E});var a=n(268),i=n(75),r=n(59),o=n(56),s=n(155),c=n(604),d=n(43),l=n(127),u=n(77),f=n(337),p=n(44),m=n(144),_=n(100),h=n(356),b=n(137),g=n(143),v=n(368),y=n(486),S=n(326),D=n(0),I=n(975),x=D.e.isActivated("1E9F2B0E-270E-4F40-9918-01DD9B46C5F0","7/2/2021","Use the page context from the list response for Web data"),C=D.e.isActivated("1d0ede26-6eb5-4fcb-be71-789d486af357","11/10/2022","Use the page context from the list response for Web data"),O=!1,w=function(){function e(e,t){this._urlDataSource=t.urlDataSource,this._pageContext=t.pageContext,this._itemUrlHelper=t.itemUrlHelper,this._vroomUrlHelper=t.vroomUrlHelper}return e.prototype.processResponse=function(e){var t=e.response,n=e.response,a=n.WebUrl,i=n.HttpRoot,r=n.ListData,o=n.rootFolder,s=n.ListSchema,d=(void 0===s?{}:s).Collapse,l=void 0===d?"FALSE":d,u=e.pageContext,p=e.requestKey,m=e.observer,_=this._urlDataSource.getKeyParams(p),h="TRUE"===l,b=this._itemUrlHelper.getItemUrlParts(p),g=this._itemUrlHelper.getUrlParts({path:b.serverRelativeListUrl,listUrl:b.fullListUrl});(a||i)&&this._processWeb({list:t,pageContext:u,requestKeyParts:_,observer:m});var v=this._processList({list:t,pageContext:u,listUrlParts:g,requestKeyParts:_,observer:m}).listRootItemKey,y=[];if(o){var S=this._processRootFolder({list:t,listUrlParts:g,requestKeyParts:_,observer:m});y.push.apply(y,S.parentItemUrls)}r&&!h&&(S=this._processListData({listData:r,listUrlParts:g,parentKey:p,requestKeyParts:_,observer:m}),y.push.apply(y,S.parentItemUrls));var D={};if(t.ParentInfo)for(var I=0,x=t.ParentInfo.ParentFolderInfo;I<x.length;I++){var C=x[I];D[C.ServerRelativeUrl]=f.t.fromHexString(C.Permissions)}for(var O=0,w=Object(c.e)(y);O<w.length;O++){var E=w[O];this._processParentItem({itemUrl:E,listUrlParts:g,parentInfo:D,requestKeyParts:_,observer:m})}return{listRootItemKey:v}},e.prototype._processListData=function(e){for(var t=e.listData.Row,n=e.parentKey,a=e.requestKeyParts,i=e.listUrlParts,r=e.observer,o=[],c="",d=0,l=t;d<l.length;d++){var u=l[d],f=u.FileRef,p=this._processRow({row:u,observer:r,requestKeyParts:a,listUrlParts:i}).key;o.push.apply(o,this._getParentItemUrls({listUrlParts:i,itemUrl:f})),r.update([new s.e(p).succeed({set:{parent:{key:n},after:{key:c}}})]),c=p}return{parentItemUrls:o}},e.prototype._processRow=function(e){var t,n,a,o=e.row,c=e.row.FileRef,d=e.listUrlParts,u=e.requestKeyParts,f=e.observer,p=this._itemUrlHelper.getUrlParts({path:c,listUrl:d.fullListUrl});if((t={})[i.n.idParamKey]=p.serverRelativeItemUrl,t[i.n.listUrlKey]=p.normalizedListUrl,a=t,this._isFolder(o)){var m={},_=this._urlDataSource.getQueryType(u),h=u[i.n.typeFiltersKey];_!==r.e.Search&&(m[i.n.queryTypeParamKey]=u[i.n.queryTypeParamKey]),h&&(m[i.n.typeFiltersKey]=h),l.e(a,m),u[i.n.metadataSearchIdKey]&&l.e(a,((n={})[i.n.metadataSearchIdKey]=u[i.n.metadataSearchIdKey],n))}var b=this._urlDataSource.getKey(a),g=this._getParentKeyForListItem({listUrlParts:d,itemUrl:c,requestKeyParts:u}),v={key:b};return g&&(v.parentKey=g),f.update([new s.e(b).succeed({item:v})]),{key:b}},e.prototype._processRootFolder=function(e){var t,n,a,r=e.list,o=e.listUrlParts,c=e.requestKeyParts,d=e.observer,l=r.rootFolder,f=this._itemUrlHelper.getUrlParts({path:l,listUrl:o.fullListUrl}),p=this._urlDataSource.getKey(((t={})[i.n.idParamKey]=f.serverRelativeItemUrl,t[i.n.listUrlKey]=f.normalizedListUrl,t[i.n.queryTypeParamKey]=c[i.n.queryTypeParamKey],t[i.n.queryParamKey]=c[i.n.queryParamKey],t[i.n.typeFiltersKey]=c[i.n.typeFiltersKey],t[i.n.metadataSearchIdKey]=c[i.n.metadataSearchIdKey],t)),_=this._getParentKeyForListItem({listUrlParts:o,itemUrl:l,requestKeyParts:c}),h={key:p,type:u.e.Folder,newWOPIDocumentEnabled:m.optional(r.NewWOPIDocumentEnabled)};if(_&&(h.parentKey=_),r.ListData){if(n=r.ListData.FolderId,"Sharepoint.DocumentSet"===r.ListData.CurrentFolderProgId){h.isDocSet=!0;var b=r.FolderContentTypeId,g=void 0,v=void 0;if(r.AvailableContentTypes)for(var y=0,S=r.AvailableContentTypes;y<S.length;y++){var D=S[y],I=D.contentTypeId;if(I&&0===I.indexOf("0x0120D520")){if(C){h.contentTypeId=I,a=D.displayName;break}if(b===I){h.contentTypeId=I,a=D.displayName;break}I&&0===I.indexOf("0x0120D520")&&(g||(g=I,v=D.displayName))}C||h.contentTypeId||(h.contentTypeId=g,a=v)}}if(r.ListData.CurrentFolderSpItemUrl){var x=this._vroomUrlHelper.getUrlParts(r.ListData.CurrentFolderSpItemUrl);h.itemId=m.optional(x.itemId),h.graph={itemId:m.optional(x.itemId),driveId:m.optional(x.driveId)}}}if(a&&h.contentTypeId?h.properties={ID:m.optional(n),ContentType:a,ContentTypeId:h.contentTypeId}:h.properties={ID:m.optional(n)},!this._isListRoot({itemUrl:l,listUrlParts:o})){var O=l.split("/").slice(-1)[0];h.name=O,h.displayName=O}return d.update([new s.e(p).succeed({item:h})]),{parentItemUrls:this._getParentItemUrls({listUrlParts:o,itemUrl:l})}},e.prototype._processWeb=function(e){var t,n=e.list,a=e.requestKeyParts,o=e.observer,c=n.HttpRoot,d=n.SiteTitle,l=n.WebUrl||c&&b.a(decodeURIComponent(c)),f=this._itemUrlHelper.getUrlParts({path:l,webUrl:l}),p=this._urlDataSource.getKey(((t={})[i.n.idParamKey]=f.normalizedItemUrl,t[i.n.queryTypeParamKey]=r.e.DocumentLibraries,t[i.n.typeFiltersKey]=a[i.n.typeFiltersKey],t)),m={serverRelativeUrl:l},_={key:p,type:u.e.Folder,subsite:m},h=!x&&e.pageContext||this._pageContext.webAbsoluteUrl===l&&this._pageContext;h&&(_.name=d,_.displayName=d,m.webTemplateId=Number(h.webTemplate),m.serverRelativeUrl=h.webAbsoluteUrl,m.id=h.webId,m.siteCollectionId=h.siteId,m.title=h.webTitle,m.icon=h.webLogoUrl),o.update([new s.e(p).succeed({item:_})])},e.prototype._processList=function(e){var t,n,o,c,d,l,f=e.list,_=e.listUrlParts,h=e.requestKeyParts,v=e.observer,y=f.ListTitle,D=f.HttpRoot,I=f.ListUrl,C=f.listUrlDir,w=I||C&&decodeURIComponent(C),E=this._urlDataSource.getKey(((t={})[i.n.idParamKey]=_.serverRelativeItemUrl,t[i.n.listUrlKey]=_.normalizedListUrl,t[i.n.queryTypeParamKey]=h[i.n.queryTypeParamKey],t[i.n.queryParamKey]=h[i.n.queryParamKey],t[i.n.typeFiltersKey]=h[i.n.typeFiltersKey],t[i.n.metadataSearchIdKey]=h[i.n.metadataSearchIdKey],t)),A=f.AllowCreateFolder,L=f.EnableMinorVersions,k=f.verEnabled,M=f.AllowGridMode,P=f.DisableGridEditing,T=f.ListTemplateType,U=f.BasePermissions,F=void 0===U?{}:U,H=F.ManageLists,R=void 0===H?void 0:H,N=F.ManagePersonalViews,B=void 0===N?void 0:N,j=F.OpenItems,V=void 0===j?void 0:j,z=F.UseClientIntegration,G=void 0===z?void 0:z,K=f.ListSchema,W=void 0===K?{}:K,q=W.DefaultItemOpen,Q=void 0===q?void 0:q,Y=W[".driveAccessTokenV21"],J=void 0===Y?void 0:Y,X=W[".driveAccessToken"],Z=void 0===X?void 0:X,$=W[".driveUrl"],ee=void 0===$?void 0:$,te=W[".driveUrlV21"],ne=void 0===te?void 0:te,ae=f.ExcludeFromOfflineClient,ie=f.WebExcludeFromOfflineClient,re=f.listBaseType,oe=Z,se=J,ce=ee,de=ne,le=!x&&e.pageContext||w===this._pageContext.listUrl&&this._pageContext,ue=null==le?void 0:le.driveInfo;f.isFromServiceWorkerCache&&ue&&(ue[".driveAccessToken"]&&(oe=ue[".driveAccessToken"]),ue[".driveAccessTokenV21"]&&(se=ue[".driveAccessTokenV21"]),ue[".driveUrl"]&&(ce=ue[".driveUrl"]),ue[".driveUrlV21"]&&(de=ue[".driveUrlV21"])),oe&&(o={accessToken:(d=Object(g.e)(oe)).access_token,proofToken:d.prooftoken,tokenUrl:ce}),se&&(c={accessToken:(d=Object(g.e)(se)).access_token,proofToken:d.prooftoken,tokenUrl:de});var fe=f.WebUrl||D&&b.a(decodeURIComponent(D));if(fe){var pe=this._itemUrlHelper.getUrlParts({path:fe,webUrl:fe});l=this._urlDataSource.getKey(((n={})[i.n.idParamKey]=pe.normalizedItemUrl,n[i.n.queryTypeParamKey]=r.e.DocumentLibraries,n[i.n.typeFiltersKey]=h[i.n.typeFiltersKey],n))}var me="string"==typeof Q?"0"===Q:void 0;me&&(O||(a.e.logData({name:"List.openInClient"}),O=!0));var _e=ce&&this._vroomUrlHelper.getUrlParts(ce)||void 0;o&&Object(S.e)({authToken:o.accessToken,proofToken:o.proofToken})&&(o=void 0),c&&Object(S.e)({authToken:c.accessToken,proofToken:c.proofToken})&&(c=void 0);var he="number"==typeof re?Object(p.a)(String(re)):void 0;return v.update([new s.e(E).succeed({item:{key:E,parentKey:m.optional(l),itemId:m.backup("root"),graph:{itemId:m.backup("root"),driveId:m.optional((null==_e?void 0:_e.driveId)||void 0),sessionToken:m.optional(o),sessionTokenV21:m.optional(c)},type:u.e.Folder,name:m.optional(y),displayName:m.optional(y),isRootFolder:!0,isDropEnabled:!0,folder:{},newWOPIDocumentEnabled:m.optional(f.rootFolder?void 0:f.NewWOPIDocumentEnabled),list:{id:m.optional(f.listName),allowGridMode:"boolean"==typeof M?M:m.backup(!0),allowCreateFolder:m.optional(A),disableCommenting:"boolean"==typeof f.DisableCommenting&&f.DisableCommenting,disableGridEditing:"boolean"==typeof P?P:m.backup(!1),enableMinorVersions:m.optional(L),enableVersions:m.optional(k),templateType:m.optional("string"==typeof T?Number(T):void 0),isDocumentLibrary:m.optional(he),isPromotedLinks:m.optional("string"==typeof T?Object(p.o)(T):void 0),isForceCheckout:m.optional(f.isForceCheckout),isModerated:m.optional(f.isModerated),newWOPIDocumentEnabled:m.optional(f.NewWOPIDocumentEnabled),newWOPIDocumentTypes:m.optional(f.NewWOPIDocumentTypes),permissions:{manageLists:m.optional(R),managePersonalViews:m.optional(B),openItems:m.optional(V),useClientIntegration:m.optional(G)},openInClient:m.optional(me),excludeFromOfflineClient:m.optional("boolean"==typeof ae||"boolean"==typeof ie?ae||ie:void 0),contentTypesEnabled:m.optional(f.ContentTypesEnabled),metadataNavFeatureEnabled:m.optional(f.metadataNavFeatureEnabled),canUserCreateMicrosoftForm:m.optional(f.canUserCreateMicrosoftForm),itemCount:m.optional(f.ListSchema&&f.ListSchema.ItemCount),rowLimit:m.optional(f.ListData.RowLimit),listUrlDir:w,createdFromExcel:m.optional(f.CreatedFromExcel),createdFromExisting:m.optional(f.CreatedFromExisting)},properties:{commandsSupported:m.optional(f.CanShareLinkForNewDocument&&{canShareLinkForNewDocument:"1"})}}})]),{listRootItemKey:E}},e.prototype._processParentItem=function(e){var t,n=e.itemUrl,a=e.listUrlParts,r=e.parentInfo,o=e.requestKeyParts,c=e.observer,d=this._itemUrlHelper.getUrlParts({path:n,listUrl:a.fullListUrl}),l=this._urlDataSource.getKey(((t={})[i.n.idParamKey]=d.serverRelativeItemUrl,t[i.n.listUrlKey]=d.normalizedListUrl,t[i.n.queryTypeParamKey]=o[i.n.queryTypeParamKey],t[i.n.queryParamKey]=o[i.n.queryParamKey],t[i.n.typeFiltersKey]=o[i.n.typeFiltersKey],t[i.n.metadataSearchIdKey]=o[i.n.metadataSearchIdKey],t)),f={key:l,parentKey:this._getParentKeyForListItem({listUrlParts:a,itemUrl:n,requestKeyParts:o}),queryType:this._urlDataSource.getQueryType(o)};if(this._isListRoot({itemUrl:n,listUrlParts:a}))f.list={};else{var p=b.n(n);f.name=p,f.displayName=p,f.type=u.e.Folder,f.isDropEnabled=!0,f.folder={},r&&r[n]&&(f.permissions=r[n])}c.update([new s.e(l).succeed({item:f})])},e.prototype._getParentKeyForListItem=function(e){var t,n,a=e.listUrlParts,r=e.itemUrl,o=e.requestKeyParts;if(a.serverRelativeListUrl!==r){if(!D.e.isActivated("556c889b-eaaf-4e07-a746-6f7c7eee8553","8/18/2021","Show a more user-friendly error when the item does not have a FileRef field")&&!r)throw new Error(I.e);var s=r.split("/").slice(0,-1).join("/"),c=this._itemUrlHelper.getUrlParts({path:s,listUrl:a.fullListUrl});n=this._urlDataSource.getKey(((t={})[i.n.idParamKey]=c.serverRelativeItemUrl,t[i.n.listUrlKey]=c.normalizedListUrl,t[i.n.queryTypeParamKey]=o[i.n.queryTypeParamKey],t[i.n.queryParamKey]=o[i.n.queryParamKey],t[i.n.typeFiltersKey]=o[i.n.typeFiltersKey],t[i.n.metadataSearchIdKey]=o[i.n.metadataSearchIdKey],t))}return n},e.prototype._getParentItemUrls=function(e){var t=e.listUrlParts,n=e.itemUrl,a=[],i=t.serverRelativeListUrl;if(0===n.indexOf(i))for(var r="",o=0,s=n.substring(i.length).split("/").slice(1,-1);o<s.length;o++){var c=s[o];r+="/".concat(c);var d="".concat(i).concat(r);a.push(d)}return a},e.prototype._isListRoot=function(e){var t=e.itemUrl;return e.listUrlParts.serverRelativeListUrl===t},e.prototype._isFolder=function(e){var t;if("1"===e.FSObjType){var n=e["File_x0020_Type.mapapp"],a=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];t=!(n&&"onenote"===n.substring(0,7)||a&&-1!==a.indexOf("onenote"))}else t=!1;return t},e.dependencies={urlDataSource:o.v,pageContext:d.i,itemUrlHelper:_.o,vroomUrlHelper:h.e,resources:v.r},e}(),E=Object(y.r)("ListItemResultProcessor",w)},898:function(e,t,n){"use strict";var a;!function(e){e[e.Public=0]="Public",e[e.PublicUnlisted=2]="PublicUnlisted",e[e.Shared=3]="Shared",e[e.Private=4]="Private",e[e.Unknown=5]="Unknown"}(a||(a={})),t.e=a},899:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=[".dcm",".dcm30",".dic",".dicm",".dicom"],i={".docm":!0,".dotm":!0,".dotx":!0,".docx":!0,".bmp":!0,".jpg":!0,".jpeg":!0,".tiff":!0,".tif":!0,".png":!0,".gif":!0,".emf":!0,".wmf":!0,".psd":!0,".svg":!0,".ai":!0,".eps":!0,".pdf":!0,".pptm":!0,".pptx":!0,".potm":!0,".potx":!0,".ppsm":!0,".ppsx":!0,".xlsm":!0,".xlsx":!0,".aspx":!0};function r(e){return!!e&&i[e.toLowerCase()]}function o(e){return a.indexOf(e)>=0}},915:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(368).t)("searchBoxDataSource")},922:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a=n(368),i=new a.t("app.admin"),r=new a.t("app.spourl");new a.t("app.suitenavrendered")},1151:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(6);function i(){return Object(a.uo)(a.Ni)}n(139)},1178:function(e,t,n){"use strict";n.d(t,"e",function(){return $});var a=n(21),i=n(40),r=n(75),o=n(154),s=n(706),c=n(59),d=n(48),l=["AverageRating","RatedBy","Ratings","LikesCount","LikedBy"],u=n(150),f=n(137),p=n(463),m=n(898),_=n(189).a,h=n(368),b=n(486),g=new h.t({name:"ListItemTrendingStatusProcessor.key",loader:new b.t(function(){return n.e(60).then(n.bind(null,1504)).then(function(e){return e.resourceKey})})}),v=n(148),y=n(77),S=n(156),D=n(1120),I=new h.t({name:"ShortcutLinkDataSource.key",loader:new b.t(function(){return Promise.all([n.e("deferred.resx-deferred"),n.e("deferred.odsp-datasources"),n.e("deferred.odsp-common"),n.e("deferred")]).then(n.bind(null,1505)).then(function(e){return e.resourceKey})})}),x=n(439),C=n(337),O=n(5),w=n(707),E=n(709),A=n(73),L=n(54),k=n(44),M=n(56),P=n(899),T=n(43),U=new h.t("vroom.dataContext"),F=n(109),H=n(155),R=n(144),N=n(100),B=n(356),j=n(421),V=n(127),z=n(1109),G=n(653),K=n(46),W=n(301),q=n(542),Q=n(111),Y=n(440),J=n(0).e.isActivated("D6DFF276-FF92-454E-AC05-F916D87BD82F","03/08/2022","Update the openUrl for items in a links list with the correct URL from server"),X=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._pageContext=n.pageContext,a._urlDataSource=n.urlDataSource,a._listContext=n.listContext,a._navigation=n.navigation,a._microServiceDataSource=n.microServiceDataSource,a._vroomUrlHelper=n.vroomUrlHelper,a._itemUrlHelper=n.itemUrlHelper,a._vroomDataContext=n.vroomDataContext,a._shortcutLinkDataSource=n.shortcutLinkDataSource,a._allowWrsVisio=!1,a._htmlDecodeDiv=document.createElement("textarea"),a}return Object(a.__extends)(t,e),t.prototype.getItemResult=function(e){try{return this._getItemResult(e)}catch(e){throw K.e.log(e,"ListItemBuilder.getItemResult"),e}},t.prototype._getItemResult=function(e){var t,n,i,l,h,b=e.itemFromServer;if(!b)return null;var I,M=e.microServiceDataSource||this._microServiceDataSource,T=this._urlDataSource,U=e.requestKey,F=e.parentItemKey,N=e.queryType,B=void 0===N?T.getQueryType():N,j=e.groupBy,K=e.itemGroups,W=e.contentTypes,Y=e.supportsNestedGroups,X=e.isItemDataOnly,$=e.listTemplateType,ee=void 0===$?this._listContext.listTemplateType:$,te=e.observer,ne=e.isMetaDataSearch,ae=T.getKeyParams(U),ie=this._itemUrlHelper.getUrlParts({path:b.id||b.FileRef||b.ServerRelativeUrl,listUrl:ae[r.n.listUrlKey]});(t={})[r.n.idParamKey]=ie.serverRelativeItemUrl,t[r.n.listUrlKey]=ie.normalizedListUrl,I=t;var re=b.File_x0020_Type,oe=re?"."+re:"",se=this._parseMediaServiceMetadata(b.MediaServiceFastMetadata),ce=this._parseMediaServiceMetadata(b.MediaServiceMetadata),de=this._getItemType({itemFromServer:b,listTemplateType:ee,microServiceDataSource:M,mediaServiceFastMetadata:se});if(de===y.e.Folder){var le=ae[r.n.idParamKey]===I[r.n.idParamKey],ue=T.getItemTypeFilter(ae),fe={};le?((n={})[r.n.queryTypeParamKey]=ae[r.n.queryTypeParamKey],n[r.n.queryParamKey]=ae[r.n.queryParamKey],n[r.n.typeFiltersKey]=ae[r.n.typeFiltersKey],fe=n):(B!==c.e.Search&&((i={})[r.n.queryTypeParamKey]=B,fe=i),ue&&V.e(fe,T.saveItemTypeFilter(ue))),V.e(I,fe),ne&&V.e(I,((l={})[r.n.metadataSearchIdKey]=ae[r.n.metadataSearchIdKey],l))}var pe=T.getKey(I),me={key:pe,extension:oe},_e=b.id||b.FileRef;me.id=_e;var he,be,ge=C.t.fromHexString(b.PermMask),ve=Q.e.hasPermission(ge,Q.e.openItems),ye=this._pageContext.blockDownloadsExperienceEnabled||this._pageContext.viewOnlyExperienceEnabled||!ve,Se=b[".spItemUrl"];if(Se){var De=this._vroomUrlHelper.getUrlParts(Se);he=De.itemId,be=De.driveId}else he=b["name.FileSystemItemId"]||(b.isRootFolder?"root":void 0);this._vroomDataContext&&he&&this._vroomDataContext.setFileSystemIdMapping(he,_e);var Ie=b[".etag"];Ie&&(me.eTag=Ie),me.itemId=R.optional(he);var xe=ee===k.t.mySiteDocumentLibrary;me.graph=R.optional(he&&{itemId:he,driveId:be,driveType:ee?xe?"business":"documentLibrary":void 0});var Ce=Number(b._ip_UnifiedCompliancePolicyUIAction)||_.none;"1"===this._navigation.viewParams[r.n.pseudoPolicyTipKey]&&(Ce=Number(b.ID)%6),me.policyTip=R.optional(Ce);var Oe=Object(P.t)(oe);if((Oe||".ai"===oe||".eps"===oe||".psd"===oe)&&M.getThumbnail({fileExtension:oe,item:b,itemKey:pe,mediaServiceMetadata:se})&&(de=y.e.Media),q.t(oe)?me.htmlConversion={}:q.e(oe)&&(we=M.getHtmlConversionUrl({fileExtension:oe,item:b,mediaServiceMetadata:se}))&&(de=y.e.Media,me.htmlConversion={url:"".concat(we,"&inlineImages=true")}),Object(O.isFeatureEnabled)(O.EnableZipFilePreviewing)&&(".zip"===oe||".rar"===oe)){var we=M.getZipMetaDataUrl({fileExtension:oe,item:b,mediaServiceMetadata:se}),Ee=M.getDownloadZipContentsUrl(b);we&&Ee&&(de=y.e.Media,me.zip={zipMetaDataUrl:we,downloadZipContentsUrl:Ee})}var Ae,Le,ke,Me,Pe,Te,Ue={},Fe=M.getDownloadAsZipUrl(b),He=Object(O.isFeatureEnabled)(O.EnableOpenInImmersiveReader)&&M.getImmersiveReaderUrl({fileExtension:oe,item:b});Fe&&(Ue[o.t.downloadAsZip]=Fe),He&&(Ue[o.t.immersiveReaderUrl]=He),Se&&(Ue[o.t.itemUrl]=Se);var Re=this._listContext,Ne=Number(b.File_x0020_Size)||Number(b.FileSizeDisplay)||void 0,Be=se&&se.video,je=".ts"===oe&&Ne<1<<19&&!Be;je&&(de=y.e.File);var Ve=se&&se.media,ze=ie.fullItemUrl,Ge=ze?f.e(ze):void 0;if(de===y.e.Folder)Ae=b.ProgId&&"sharepoint.documentset"===b.ProgId.toLowerCase();else if(de!==y.e.Media&&!se||Object(k.o)(ee))de===y.e.File&&Re&&void 0!==Re.isDocLib&&!Re.isDocLib&&(Le={});else{var Ke=u.t(oe),We=se&&se.photo||(Oe||"photo"===Ke?{}:void 0),qe=Be||("video"===Ke?{}:void 0),Qe=se&&se.audio||("audio"===Ke?{}:void 0);We&&(ke={originalUrl:R.optional("photo"===Ke?Ge:void 0),width:We.width||0,height:We.height||0},Object(O.isFeatureEnabled)(O.Image360Viewer)&&he&&(Me=this._getImage360(b,se,We,ce))),qe&&(Pe={fourCC:R.optional(qe.fourCC||(".mp4"===oe.toLowerCase()?"H264":void 0)),bitrate:R.optional(qe.encodingBitrate),width:qe.frameWidth||0,height:qe.frameHeight||0,duration:Z(Ve&&Ve.duration),audioFormat:R.optional(Qe&&Qe.format),manifestMetadata:qe.manifestMetadata,altManifestMetadata:qe.altManifestMetadata}),Qe&&(Te={duration:Z(Ve&&Ve.duration)})}var Ye=Ve&&Ve.title;me.caption=R.optional(Ye),me.photo=R.optional(ke),me.image360=R.optional(Me),me.video=R.optional(Pe),me.audio=R.optional(Te),me.listItem=R.optional(Le),F&&(me.parentKey=F),me.isDocSet=R.optional(Ae),ie.serverRelativeItemUrl===ie.serverRelativeListUrl&&(me.isRootFolder=!0);var Je,Xe=z.e.getItemName(b,de,Re);me.name=R.optional(Xe),me.displayName=R.optional(Xe);var Ze,$e=!0;if(b.Modified&&"21"===this._pageContext.webTemplate&&Object(O.isFeatureEnabled)(O.RequestDatesInUtc))try{var et=new Date(b.Modified);me.dateModifiedTime=et,me.dateModifiedValue=et.getTime(),Je=Object(S.n)(et),$e=!1}catch(e){}if($e&&(me.dateModifiedValue=R.optional(b.Modified),Je=b["Modified.FriendlyDisplay"]?Object(D.e)(b["Modified.FriendlyDisplay"]):b.Modified?"".concat(b.Modified):""),me.dateModified=R.optional(Je||void 0),me.permissions=R.optional(ge),K&&j&&j.length>0)if(Y){K[0]||(K[0]=[]);var tt=K[0]&&K[0].length>0?K[0][K[0].length-1]:null,nt=j[0],at=j[1];if(nt&&"1"===b[nt+".newgroup"]){var it=tt?tt.startIndex+tt.count:0,rt=Object(G.t)(Re,b,nt,0,!1,it),ot=this._convertToODNGroup(rt);K[0].push(ot),tt=ot}if(at&&"1"===b[at+".newgroup"]){var st=tt&&tt.children&&tt.children.length>0?tt.children[tt.children.length-1]:null;it=st?st.startIndex+st.count:tt?tt.startIndex:0,Object(G.t)(Re,b,at,1,!1,it,tt);var ct=tt.children.pop();tt.children.push(this._convertToODNGroup(ct))}}else for(var dt=0;dt<j.length;dt++){var lt=j[dt];if(lt){var ut=K[dt]&&K[dt].length>0?K[dt][K[dt].length-1]:null;"1"===b[lt+".newgroup"]&&(it=ut?ut.startIndex+ut.count:0,ot=Object(G.t)(Re,b,lt,dt,!1,it),K[dt]||(K[dt]=[]),K[dt].push(this._convertToODNGroup(ot)))}}if(W&&W.length>0&&b.ContentTypeId)for(var ft=0,pt=W;ft<pt.length;ft++){var mt=pt[ft];if(b.ContentTypeId===mt.contentTypeId&&(Ze=!1,mt.requiredFields))for(var _t=0,ht=mt.requiredFields.split(",");_t<ht.length;_t++){var bt=b[ht[_t]];if(!bt||Array.isArray(bt)&&0===bt.length){Ze=!0;break}}}me.hasMissingMetadata=R.optional(Ze),me.contentTypeId=R.optional(b.ContentTypeId);var gt,vt,yt,St,Dt,It=b.folder,xt=[];if(It){if(me.folder={},me.isDropEnabled=!0,gt=[],It.children){for(var Ct=0,Ot=It.children,wt=Ot.length,Et=0,At=0;At<wt;At++){var Lt=this.getItemResult({requestKey:U,queryType:B,itemFromServer:Ot[At],groupBy:j,itemGroups:xt,contentTypes:W,listTemplateType:ee,supportsNestedGroups:Y,isItemDataOnly:X,observer:te,isMetaDataSearch:ne,pageContext:e.pageContext});Lt&&(gt[At]=Lt.item,Et<10&&Lt.itemType===y.e.Media&&Ct++,Et++)}wt>0&&(Ct>=10||Ct>=wt)&&(me.displayType=c.e.Photos)}}else{if(yt=(yt=b["serverurl.progid"])?yt.substring(1):J||ee!==k.t.links?Ge:b.URL,Ue[o.t.original]=yt,Object(O.isFeatureEnabled)(O.ShortcutLink)&&x.e.isShortcutItem({key:pe,extension:oe})&&(de=y.e.Shortcut,b._ShortcutUrl?(me.shortcutInfo={shortcutLinkRewritten:!0},Ue[o.t.shortcutTarget]=this._shortcutLinkDataSource.generateShortcutsOpenUrl(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl,b._ShortcutUrl,b._ShortcutSiteId,b._ShortcutWebId,b._ShortcutUniqueId),b._ShortcutUniqueId&&(vt=s.previewImageUrl({url:b._ShortcutUrl,siteId:b._ShortcutSiteId,webId:b._ShortcutWebId,uniqueId:b._ShortcutUniqueId},this._pageContext.webAbsoluteUrl,this._pageContext))):(me.shortcutInfo=R.backup({shortcutLinkRewritten:!1}),this._shortcutLinkDataSource.enqueueParseShortcut(pe,e.itemFromServer.ID),Ue[o.t.shortcutTarget]=d.t.concatenate(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl)+"/ShortcutLink.aspx?shortcut="+A.e.encodeURIComponent(b.FileRef))),Ue[o.t.open]=yt,St=b["File_x0020_Type.mapapp"]||b["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],ie.isCrossDomain&&ie.isCrossList){var kt=b[".fileType"],Mt=w.n(kt||"");St=void 0===Mt?kt?void 0:St:Mt,"OneNote.Notebook"===b.HTML_x0020_File_x0020_Type&&(St="onenote|UsePlain"),"pdf"===b.File_x0020_Type&&(St=void 0)}me.size=R.optional(Ne),me.totalSize=R.optional(Number(b.SMTotalSize)||void 0),vt||(vt=this._getThumbnail({itemFromServer:b,listTemplateType:ee,extension:oe,key:pe,type:de,mediaServiceFastMetadata:se,microServiceDataSource:M,pageContext:e.pageContext})),me.openUrl=yt;var Pt=b["IconOverlay.mapoly"];Pt&&(me.overlayUrl="/"+this._pageContext.layoutsUrl+"/images/"+Pt),me.thumbnail=vt;var Tt=this._getPdfConversionFacet({extension:oe,blockDownload:ye,itemFromServer:b,microServiceDataSource:M,mediaServiceFastMetadata:se});Tt&&(me.pdfConversion=Tt);var Ut=this._get3dFacet({extension:oe,itemFromServer:b,microServiceDataSource:M,mediaServiceFastMetadata:se});if(Ut&&(me.model3d=Ut),de===y.e.Folder){var Ft=Number(b.ItemChildCount)+Number(b.FolderChildCount);me.childCount=Ft;var Ht=Number(b.SMTotalFileCount);me.folder={totalCount:Ht>0?Ht:Ft,childCount:Ft},me.isDropEnabled=!0}var Rt=b.ServerRedirectedEmbedUrl;Rt&&(this._itemUrlHelper.getUrlParts({path:Rt}).isCrossDomain||(Dt=Rt))}me.previewIFrameUrl=Dt,me.type=de,me.appMap=R.optional(St),this._pageContext.blockDownloadsExperienceEnabled&&(me.type===y.e.Media||yt&&St)?me.itemStatus=v.t.ConditionalAccessViewOnly:this._pageContext.blockDownloadsExperienceEnabled&&de!==y.e.Folder?me.itemStatus=v.t.ConditionalAccessBlocked:this._pageContext.viewOnlyExperienceEnabled&&(me.itemStatus=v.t.ConditionalAccessViewOnly);var Nt={};for(var Bt in b)b.hasOwnProperty(Bt)&&(Nt[Bt]=b[Bt]);var jt=L.e.normalizeLower(b.UniqueId)||void 0;jt&&(Nt.uniqueId=jt);var Vt=b.RemoteItem;me.remoteItem=Vt&&JSON.parse(Vt),me.reputationProperties=this.getReputationProperties(b);var zt,Gt=Xe;oe&&(Gt=Xe.substring(0,Xe.toLowerCase().lastIndexOf(oe.toLowerCase()))),me.sharingRole=p.e.Owner,zt=Number(b.PrincipalCount)>0?m.e.Shared:void 0===b.PrincipalCount?O.isOneDrive?void 0:m.e.Unknown:m.e.Private,me.sharingType=R.optional(zt),Nt.FileName=Gt;var Kt=u.n({extension:oe,isDocSet:Ae,listItem:Le,sharingType:zt,type:de,textEditorMimeType:je?"text/typescript":void 0,panorama:Me,isMountPoint:!!Vt});me.iconName=Kt;var Wt,qt,Qt="ms-powerpoint"===St,Yt="ms-visio"===St,Jt="ms-word"===St;if(yt&&(Jt||"ms-excel"===St||Qt||Yt)){var Xt=this._getOfficeBundleFacet({isWord:Jt,extension:oe,itemUrlParts:ie,isPowerPoint:Qt,itemFromServer:b,microServiceDataSource:M,mediaServiceFastMetadata:se});!Xt||Yt&&!this._allowWrsVisio||(me.officeBundle=Xt),Xt&&(Jt||Qt)&&(Ue[o.t.viewInBrowser]=M.getPdfConversionUrl({fileExtension:oe,item:b,mediaServiceMetadata:se},!0)),me.wopiFrameUrl=yt}me.defaultSubText=E.e(E.t(b.Editor)),me.isPlaceholder=!b.PermMask,me.queryType=B,me.displayType=R.backup(me.queryType),me.isDraggable=me.queryType===c.e.Files,b.folder||(Nt.modifiedByUser=E.a(b.Editor)),Nt.MediaServiceOCR=E.i(b.MediaServiceOCR),me.properties=Nt,me.lifeCycleStatus=R.optional(this._getItemLifeCycleStatus(b)),me.comments={settings:(Wt=b._CommentFlags,qt={},qt.isCommentDisabled=function(e){return void 0===e||null==e||(1&e)>0}(Wt),qt)},me.urls=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},Ue),this._getVideoUrl({extension:oe,itemFromServer:b,microServiceDataSource:M,mediaServiceFastMetadata:se})),((h={})[o.t.mediaBaseUrl]=M.getMediaBaseUrl({fileExtension:oe,item:b,mediaServiceMetadata:se}),h)),me.searchProperties={isMetadataSearch:ne},null==te||te.update([new H.e(pe).succeed({item:me})]),te&&Object(O.isFeatureEnabled)(O.ItemAnalytics)&&Object(O.isFeatureEnabled)(O.EnableTrendingSignalInListView)&&pe&&this.resources.consumeAsync(g).then(function(e){e.queueNewItem(pe)});var Zt=this._getGroupings({itemFromServer:b,supportsNestedGroups:Y,groupBy:j,groups:xt}),$t=Zt.groupings,en=Zt.totalChildren;return{item:{key:pe},itemPatch:me,itemType:de,children:gt,groupings:$t,totalChildren:en,nextRequestToken:b.nextRequestToken}},t.prototype._getItemLifeCycleStatus=function(e){var t={};1===Number(e["Created_x0020_Date.ifnew"])&&(t.isNew=!0);var n=Number(e._VirusStatus)||0;return 0!==n&&3!==n&&(t.isMalwareDetected=!0),t},t.prototype._getGroupings=function(e){var t=this,n=e.itemFromServer,a=e.supportsNestedGroups,i=e.groupBy,r=e.groups,o=null,s=this._listContext.groupLevel,c=n.folder?n.folder.childCount:0;if(n.folder&&n.folder.children&&i&&"__ItemType"===i[0])o=this._getItemTypeGroupings({itemFromServer:n});else if(-1!==s)if(n.groups){var d=[],l=0;if(a){var u=Object(G.e)(n.groups,this._listContext,i),f=u.groups,p=u.totalCount;d=f.map(function(e){return t._convertToODNGroup(e)}),l=p}else for(var m=0,_=n.groups;m<_.length;m++){var h=_[m],b=i[s];if(h[b+".newgroup"]){var g=Object(G.t)(this._listContext,h,b,s,!0,l);d.push(this._convertToODNGroup(g)),l+=g.count}}d&&d.length>0&&(o=[{name:void 0,itemGroups:d,isAllCollapsed:this.createObservable(!0)}],c=l)}else r&&r.length>0&&r[s]&&r[s].length>0&&(o=[{name:void 0,itemGroups:r[s],isAllCollapsed:this.createObservable(!1)}]);return{groupings:o,totalChildren:c}},t.prototype._getItemTypeGroupings=function(e){for(var t,n=e.itemFromServer,a=[],i=n.folder.children,r=n.nextRequestToken?2:0,o=i.length+r,s=0;s<o;s++){var c=i[s];if(c&&this._getItemTypeOneNoteOrFolder(c)!==y.e.Folder){t=s;break}}return(void 0===t&&o>0||t>0)&&a.push({count:void 0!==t?t:o,groupingId:"folder",startIndex:0,state:this.createObservable({isCollapsed:!1})}),void 0!==t&&a.push({count:o-t,startIndex:t,groupingId:"document",state:this.createObservable({isCollapsed:!1})}),a.length?[{name:"FoldersDocumentsPhotos",itemGroups:a,isAllCollapsed:this.createObservable(!1)}]:void 0},t.prototype._getImage360=function(e,t,n,a){var i,r=t&&t.panorama,o=!1;if(r&&"equirectangular"===r.projectionType?(i={projectionType:r.projectionType},o=!0):e.FileLeafRef&&-1!==e.FileLeafRef.indexOf(".360")?i={projectionType:"equirectangular"}:n.width>0&&n.height>0&&n.width/n.height==2&&(o=!0),o&&a){var s=a.panorama;if(s)i={projectionType:R.optional(r.projectionType||void 0),croppedAreaImageHeightPixels:R.optional(s.croppedAreaImageHeightPixels||void 0),croppedAreaImageWidthPixels:R.optional(s.croppedAreaImageWidthPixels||void 0),croppedAreaLeftPixels:R.optional(s.croppedAreaLeftPixels||void 0),croppedAreaTopPixels:R.optional(s.croppedAreaTopPixels||void 0),fullPanoHeightPixels:R.optional(s.fullPanoHeightPixels||void 0),fullPanoWidthPixels:R.optional(s.fullPanoWidthPixels||void 0),initialHorizontalFOVDegrees:R.optional(s.initialHorizontalFOVDegrees||void 0),initialVerticalFOVDegrees:R.optional(s.initialVerticalFOVDegrees||void 0),initialViewHeadingDegrees:R.optional(s.initialViewHeadingDegrees||void 0),initialViewPitchDegrees:R.optional(s.initialViewPitchDegrees||void 0),initialViewRollDegrees:R.optional(s.initialViewRollDegrees||void 0),poseHeadingDegrees:R.optional(s.poseHeadingDegrees||void 0),posePitchDegrees:R.optional(s.posePitchDegrees||void 0),poseRollDegrees:R.optional(s.poseRollDegrees||void 0)};else{var c=a.photo;if(c&&c.cameraModel){var d=c.cameraModel.toLowerCase();["gopro fusion 360","kodak pixpro - 360","ricoh theta","ricoh theta s","ricoh theta sc","ricoh theta v"].indexOf(d)>=0&&(i={projectionType:"equirectangular"})}}}return i},t.prototype.getReputationProperties=function(e){for(var t={},n=0,a=l;n<a.length;n++){var i=a[n];t[i]=R.optional(e[i])}return t},t.prototype._getPdfConversionFacet=function(e){var t,n={fileExtension:e.extension,item:e.itemFromServer,mediaServiceMetadata:e.mediaServiceFastMetadata};if(t=e.blockDownload&&Y.t(e.extension)?e.microServiceDataSource.getPassthroughUrl(n):e.microServiceDataSource.getPdfConversionUrl(n))return{url:t}},t.prototype._get3dFacet=function(e){if(this._pageContext.isSPO){var t=e.microServiceDataSource.getFbxConversionUrl({fileExtension:e.extension,item:e.itemFromServer}),n=W.t(e.extension);if(t||n)return{canConvert:!0,canRenderNative:n,conversionUrl:t&&t.replace("/bxf?","/glb?")}}},t.prototype._getOfficeBundleFacet=function(e){var t=e.isWord,n=e.extension,a=e.itemUrlParts,i=e.isPowerPoint,r=e.itemFromServer,o=e.microServiceDataSource,s=e.mediaServiceFastMetadata,c=a.isCrossDomain;if(!c&&("21"===this._pageContext.webTemplate||Object(O.isFeatureEnabled)(O.EnableWrsPreviewOutsideODB))){var d,l,u,f=!c&&(t&&Object(O.isFeatureEnabled)(O.EnableWordWrsPreview)||i&&Object(O.isFeatureEnabled)(O.EnablePowerPointWrsPreview)),p=t||i?o.getOfficeBundleGenerateUrl({fileExtension:n,item:r,mediaServiceMetadata:s}):"",m=o.getOfficeBundleGetFragmentUrl({fileExtension:n,item:r,mediaServiceMetadata:s}),_=!1,h="",b=r[".ctag"],g=s&&s.officeBundle;return g&&(d=g.ctag,u=g.version,_=g.fatalError||!1,g.generationTime&&(l=new Date(g.generationTime)),h=g.errorInfo||""),{officeBundleGenerateUrl:p,officeBundleGetFragmentUrl:m,bundleCTag:d,bundleVersion:u,hasBundleGenerationFailed:_,bundleErrorInfo:h,generationTime:l,cTag:b,enableDefaultClick:f}}},t.prototype._getThumbnail=function(e){if(e.type!==y.e.Folder){var t=e.itemFromServer;if(Object(k.o)(e.listTemplateType))return{url:t.BackgroundImageLocation,width:0,height:0};var n=e.microServiceDataSource.getThumbnail({fileExtension:e.extension,allowCookieAuth:e.listTemplateType===k.t.mySiteDocumentLibrary,itemKey:e.key,item:t,mediaServiceMetadata:e.mediaServiceFastMetadata});if(n)return n;if(Object(P.e)(e.extension)){if(this._listContext.remoteParentWeb){var a=new d.t(this._listContext.remoteParentWeb.serverRelativeUrl).getLeftPart(d.e.authority),i=encodeURI(t.FileRef);return s.previewImageUrlFromUrl(A.e.encodeURIComponent(a+i),this._pageContext.webAbsoluteUrl,this._pageContext)}var r=e.pageContext;return r&&r.webAbsoluteUrl&&r.siteId&&r.webId?s.previewImageUrlFromProps(r.siteId,r.webId,t.UniqueId,r.webAbsoluteUrl,r):s.previewImageUrl(t,this._pageContext.webAbsoluteUrl,this._pageContext)}}},t.prototype._getVideoUrl=function(e){var t=e.microServiceDataSource.getVideoUrl({fileExtension:e.extension,item:e.itemFromServer,mediaServiceMetadata:e.mediaServiceFastMetadata}),n={};return t&&(n[o.t.video]=t),n},t.prototype._getItemType=function(e){var t=e.itemFromServer,n=e.listTemplateType,a=e.microServiceDataSource,i=e.mediaServiceFastMetadata,r=this._getItemTypeOneNoteOrFolder(t);if(r===y.e.Unknown){var o=t.File_x0020_Type,s=o?".".concat(o):"";if(Object(O.isFeatureEnabled)(O.ShortcutLink)&&x.e.isShortcutFileType(o))return y.e.Shortcut;if(Object(O.isFeatureEnabled)(O.UseWebPdfViewer)&&("pdf"===o||this._getPdfConversionFacet({itemFromServer:t,extension:s,mediaServiceFastMetadata:i,blockDownload:!0,microServiceDataSource:a})))return y.e.Media;if(this._get3dFacet({itemFromServer:t,extension:s,microServiceDataSource:a,mediaServiceFastMetadata:i}))return y.e.Media;if("audio"===u.t(s))return y.e.Media;if(i)return y.e.Media;if((r=u.a(s))===y.e.Unknown)return Object(k.r)(n)?y.e.File:Object(k.o)(n)?y.e.Media:r}return r||y.e.File},t.prototype._getItemTypeOneNoteOrFolder=function(e){var t;if(e.folder)t=y.e.Folder;else if("1"===e.FSObjType||e.RemoteItem){var n=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],a=e["File_x0020_Type.mapapp"];t=a&&"onenote"===a.substring(0,7)||n&&-1!==n.indexOf("onenote")?y.e.OneNote:y.e.Folder}else t=y.e.Unknown;return t},t.prototype._convertToODNGroup=function(e){var t=this,n=e;return n.state=this.createObservable({isCollapsed:e.isCollapsed}),n.children&&n.children.length>0&&(n.children=e.children.map(function(e){return t._convertToODNGroup(e)})),n},t.prototype._parseMediaServiceMetadata=function(e){if(e&&"{}"!==e)try{var t=e;return"&"===e[1]&&(this._htmlDecodeDiv.innerHTML=e,t=this._htmlDecodeDiv.innerText),JSON.parse(t)}catch(e){}finally{this._htmlDecodeDiv.innerHTML=""}},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{pageContext:T.i,urlDataSource:M.v,listContext:T.n,navigation:F.e,microServiceDataSource:j.e,vroomUrlHelper:B.e,itemUrlHelper:N.o,vroomDataContext:U.optional,shortcutLinkDataSource:I}),t}(i.n);function Z(e){return"number"==typeof e?e/1e4:e}var $=Object(b.r)("ListItemBuilder",X)},1324:function(e,t,n){"use strict";n.r(t);var a=n(21),i=n(524),r=function(){function e(){}return e.isOpenDebugWindowEvent=function(e){return!(e.keyCode!==i.e.graveAccent||!e.ctrlKey&&!e.altKey||e.shiftKey)},e.isOpenSimplePerfDashboardEvent=function(e){return!(e.keyCode!==i.e.f8||!e.ctrlKey&&!e.altKey||e.shiftKey)},e.initSimplePerfDashboard=function(t){e._perfDashboardOpen||(e._markPerfDashboardOpen(!0),n.e(43).then(n.bind(null,1186)).then(function(n){n.show(t,e._markPerfDashboardOpen)}))},e.isInitialized=function(){return e._initialized},e.init=function(t){e._initialized||Object(a.__awaiter)(this,void 0,void 0,function(){var i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,n.e(29).then(n.bind(null,1360))];case 1:return i=a.sent().default,e._initialized||(e._initialized=!0,i.init(t)),[2]}})})},e.enableAutoOpen=function(e){},e._markPerfDashboardOpen=function(t){e._perfDashboardOpen=t},e.AutoOpenSessionKey="DebugWindow_AutoOpen",e}();t.default=r},1474:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return z});var a,i=n(21),r=n(44),o=n(2),s=n(76),c=n(95),d=n(368),l=n(486),u=n(142),f=n(121),p=function(){var e,t,n;return a||(a=null===(n=null===(t=null===(e=window.mssearchux)||void 0===e?void 0:e.header)||void 0===t?void 0:t.getInstrumenter)||void 0===n?void 0:n.call(t)),a},m=function(e,t){var n,a,i=t||h(),r=e||b().activeScopeId;try{for(var o=Object(f.r)(i||[]),s=o.next();!s.done;s=o.next()){var c=s.value;if(c.id===r)return c}}catch(e){n={error:e}}finally{try{s&&!s.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}},_=function(e,t){var n;t&&(a=t);var i=p();i&&i.setProps({hostAppInfo:Object(f.e)(Object(f.e)({},i.props.hostAppInfo),{scopeId:null===(n=m(e.activeScopeId,e.scopes))||void 0===n?void 0:n.searchBoxScopeId}),scopingControl:Object(f.e)({},e)})},h=function(){var e;return null===(e=b())||void 0===e?void 0:e.scopes},b=function(){var e;return null===(e=p())||void 0===e?void 0:e.props.scopingControl},g=n(58),v=n(684),y=new d.t("scopingControlDataSource"),S=n(915),D=n(274),I=(n(139),n(883)),x={id:"spListFolder",name:I.t},C={id:"spList",name:I.r},O={id:"spDocLibFolder",name:I.t},w={id:"spDocLib",name:I.i};I.o,I.a,I.e,I.n,I.h;var E,A=n(282),L=n(6),k=n(12),M=n(233),P=n(0),T=n(409),U=n(1330),F=n("react-dom-lib"),H=n(724),R=n("react-lib"),N=Object(H.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e(61)]).then(n.bind(null,1503))];case 1:return[2,e.sent().MetadataSearchTeachingBubble]}})})}),B=document.createElement("div");function j(){Object(F.unmountComponentAtNode)(B)}var V=function(){function e(e,t){this._isConfigured=!1,this._resources=t.resources,this._engagement=t.engagement,this._searchBoxDataSource=t.searchBoxDataSource,this._config=t.searchBoxConfig,this._scope=new u.e,this._getViewParams=function(){throw new Error("Search box not configured")},this._isLastPageSearch=!1,this._searchInstrumenter=this._config.getInstrumenter(),this._scopingControlDataSource=t.scopingControlDataSource,this._metadataSearchDataSource=t.metadataSearchDataSource,this._bootOptions=t.bootOptions,this._teachingBubbleProvider=t.teachingBubbleProvider}return e.prototype.configureSearchBox=function(e){var t=this;if(this._config.isEnabled()){var n=new s.e({name:"SuiteNavSearchBox.Configure"});this._getViewParams=e,this._isLastPageSearch=this._searchBoxDataSource.isSearchResultsPage(),this._resources.consumeAsync(this._searchBoxDataSource.getSuiteNavProviderKey()).then(function(e){e.getO365Shell().then(function(e){e.OnHasMember("Search",function(){var a,r,s,d,l=e.Search;Object(L.uo)(L.oa)&&!(null===(a=t._metadataSearchDataSource)||void 0===a?void 0:a.isMetadataSearchResultPage(t._getViewParams()))||l.SetSearchText(t._config.getSearchText()),l.SetPlaceholderText(t._config.getPlaceholderText()),l.SetTokenProviders(t._searchBoxDataSource.getTokenProviders());var u=l.OnSubmitSearch(t._onSubmitSearchCallback.bind(t)),f=l.OnSearchBoxActivated(t._onSearchBoxActivatedCallback.bind(t)),p=l.OnSearchBoxDeactivated(t._onSearchBoxDeactivatedCallback.bind(t));t._trackHandler(u,l.RemoveOnSubmitSearch),t._trackHandler(f,l.RemoveOnSearchBoxActivated),t._trackHandler(p,l.RemoveOnSearchBoxDeactivated);var m,_=l.OnExitSearch(t._onExitSearchCallback.bind(t));t._trackHandler(_,l.RemoveOnExitSearch),t._searchBoxDataSource.getProviderConfigUpdaters&&l.SetProviderConfigUpdaters(t._searchBoxDataSource.getProviderConfigUpdaters(null===(r=t._scopingControlDataSource)||void 0===r?void 0:r.getActiveScope.bind(t._scopingControlDataSource),t._getViewParams)),(Object(L.uo)(L.oa)||Object(L.uo)(L.ma))&&(t._shouldDisableSetSearchBoxSettingsInChromeless()&&(null===(s=t._bootOptions)||void 0===s?void 0:s.chromeless)&&!(null===(d=t._bootOptions)||void 0===d?void 0:d.isListHome)&&!t.shouldSetSearchBoxSettings(l)||l.SetSearchBoxSettings(Object(i.__assign)({cache:void 0,instrumenter:t._config.getInstrumenter(),tokenProviders:t._config.getTokenProviders()},o.t.isActivated("8852ae00-f7e0-4a74-bf2e-f5f33e61fde7","09/30/2020","[stvikenv] Specify search box loading pattern in SetSearchBoxSettings in odsp-next.")?{}:{loadingPattern:(E||(E=k.n.isFeatureEnabled({ODB:1804})||(m=window._spPageContextInfo)&&!P.e.isActivated("1166a987-eb1e-4f42-baf6-46d50b7fc0c4","09/30/2020","[stvikenv] Activate this kill switch to pause experiment 90065 - using the PFP loading pattern in the search box.")&&1===Object(M.n)(90065,m)?"pfp":"eager"),E)}))),t._updateSearchInstrumenter(),n.end({resultType:c.e.Success})})}).catch(function(e){n.end({resultType:c.e.Failure,error:e.message,resultCode:"getO365ShellError"})})}).catch(function(e){n.end({resultType:c.e.Failure,error:e.message,resultCode:"getSuiteNavProviderError"})}),this._updateSearchInstrumenter(),this._isConfigured=!0}},e.prototype.updateSearchBoxConfiguration=function(e,t){var n,a,i,d;null===(a=(n=this._searchBoxDataSource).setIsPrimedLibrary)||void 0===a||a.call(n,t),!o.t.isActivated("aa2a6471-d9a3-4277-8151-55fd6b5b4b27","11/18/2022","set isGenericList")&&e&&(null===(d=(i=this._searchBoxDataSource).setIsGenericList)||void 0===d||d.call(i,Object(r.r)(e))),this._listTemplate=e,this._isMetadataSearchSupported=this._isMetadataSearchSupportedTemplate(this._listTemplate);var l=new s.e({name:"SuiteNavSearchBox.UpdateSearchBoxConfiguration"});if(this._isConfigured)try{this._resetSearchBoxText(),this._updateSearchInstrumenter(),l.end({resultType:c.e.Success})}catch(e){l.end({resultType:c.e.Failure,error:e,resultCode:"RuntimeError"})}else l.end({resultType:c.e.Failure,resultCode:"SearchBoxNotInitialized"})},e.prototype.dispose=function(){this._scope.dispose()},e.prototype._shouldDisableSetSearchBoxSettingsInChromeless=function(){return!o.t.isActivated("4385e4cc-3ff4-4707-a6b7-ca36740100a0","2020/11/12","Disable SetSearchBoxSettings when chromeless")},e.prototype._isMetadataSearchSupportedTemplate=function(e){var t;if(!this._metadataSearchDataSource)return!1;var n=!!e&&!Object(r.r)(e);return Object(L.uo)(L.v)?(n=!0,this._metadataSearchDataSource.isList=!!e&&Object(r.r)(e)):n=n||(null===(t=this._metadataSearchDataSource)||void 0===t?void 0:t.isMetadataSearchResultPage(this._getViewParams())),n},e.prototype.shouldSetSearchBoxSettings=function(e){var t=e.GetSearchBoxSettings();return!(null==t?void 0:t.instrumenter)},e.prototype._runInShellSearch=function(e){return this._resources.consumeAsync(this._searchBoxDataSource.getSuiteNavProviderKey()).then(function(e){return e.getO365Shell()}).then(function(t){t.OnHasMember("Search",function(){return e(t.Search)})})},e.prototype._resetSearchBoxText=function(e){var t=this,n=this._searchBoxDataSource.isSearchResultsPage(),a=Object(L.uo)(L.oa);this._config.isEnabled()&&this._runInShellSearch(function(e){(!a||n||t._isLastPageSearch)&&e.SetSearchText(t._config.getSearchText()),e.SetPlaceholderText(t._config.getPlaceholderText()),t._isLastPageSearch=n})},e.prototype._trackHandler=function(e,t){this._scope.attach({dispose:function(){return t(e)}})},e.prototype._onSubmitSearchCallback=function(e,t,n){var a,i,r,o=this._getViewParams();this._searchBoxDataSource.isSearchResultsPage()||(this._viewParamsBeforeSearch=o,this._urlBeforeSearch=window.location.href),this._isScopeControlSupported()&&(r=this._scopingControlDataSource.getScopeControlScenario(this._scopingControlDataSource.getInitialScope(),this._searchBoxDataSource.isSearchResultsPage()),i=this._scopingControlDataSource.getActiveScope()),this._engagement.logData({name:"SuiteNavSearchBox.Click",isIntentional:!0,extraData:{trigger:n?"ScopingControl":"SubmitSearch",targetScope:null==i?void 0:i.id},scenario:r,privacyClassification:g.t.optionalDiagnostic}),this._searchBoxDataSource.onSubmitSearchCallback(e,this._getViewParams,null===(a=this._scopingControlDataSource)||void 0===a?void 0:a.getActiveScope(),this._urlBeforeSearch,n),this._endQos("Click")},e.prototype._onExitMetadataSearchCallback=function(){var e,t,n=this;if(null===(e=this._metadataSearchDataSource)||void 0===e?void 0:e.isMetadataSearchMode){this._metadataSearchDataSource.isMetadataSearchMode=!1;var a=null===(t=this._scopingControlDataSource)||void 0===t?void 0:t.getActiveScope.bind(this._scopingControlDataSource);this._runInShellSearch(function(e){e.SetProviderConfigUpdaters(n._searchBoxDataSource.getProviderConfigUpdaters(a,n._getViewParams)),n._updateSearchInstrumenter()})}},e.prototype._onExitSearchCallback=function(){this._searchBoxDataSource.onExitSearchCallback&&(this._searchBoxDataSource.isSearchResultsPage()&&(this._engagement.logData({name:"SuiteNavSearchBox.ExitSearch",isIntentional:!0}),this._searchBoxDataSource.onExitSearchCallback(this._viewParamsBeforeSearch)),this._onExitMetadataSearchCallback())},e.prototype._onSearchBoxActivatedCallback=function(){var e;this._isScopeControlSupported()&&(e=this._scopingControlDataSource.getScopeControlScenario(this._scopingControlDataSource.getInitialScope(),this._searchBoxDataSource.isSearchResultsPage())),this._engagement.logData({name:"SuiteNavSearchBox.FocusIn",isIntentional:!0,scenario:e,privacyClassification:g.t.optionalDiagnostic,extraData:{isMetadataSearchAvailable:!!this._metadataSearchDataSource}}),this._startQos(),this._metadataSearchDataSource&&this._metadataSearchDataSource.getSiteColumns()},e.prototype._onSearchBoxDeactivatedCallback=function(){this._engagement.logData({name:"SuiteNavSearchBox.FocusOut",isIntentional:!0,privacyClassification:g.t.optionalDiagnostic}),this._endQos("FocusOut")},e.prototype._startQos=function(){this._currentQosEvent&&this._currentQosEvent.end({resultType:c.e.Failure}),this._currentQosEvent=new s.e({name:"SuiteNavSearchBox.Usage"})},e.prototype._endQos=function(e){this._currentQosEvent&&(this._currentQosEvent.end({resultType:c.e.Success,resultCode:e}),this._currentQosEvent=void 0)},e.prototype._updateSearchInstrumenter=function(){if(this._triggerSearchBoxReconfiguration(),this._isScopeControlSupported()){_(this._getScopingControlConfig(),this._searchInstrumenter);var e=this._scopingControlDataSource.getInitialScope();this._scopingControlDataSource.setActiveScope(e)}this._setSearchInstrumenterProps(),this._configureMetadataSearch()},e.prototype._isScopeControlSupported=function(){return!!this._scopingControlDataSource&&this._scopingControlDataSource.isScopingControlEnabled()},e.prototype._isMetadataSearchSupportedScope=function(e){var t=e||w,n=t===w||t===O,a=t===C||t===x;return Object(L.uo)(L.v)?n||a:n},e.prototype._getScopingControlConfig=function(){var e=this;if(!this._isScopeControlSupported())throw new Error("Scoping control is not supported.");return{scopes:this._scopingControlDataSource.getAvailableScopes(),activeScopeId:this._scopingControlDataSource.getInitialScope().id,onChange:function(t,n){e._scopingControlDataSource.setActiveScope(n),e._triggerSearchBoxReconfiguration();var a=!!t&&e._searchBoxDataSource.isSearchResultsPage();e._logScopeChange(n,a),a?e._onSubmitSearchCallback(t,void 0,!0):e._setFocusSearchBox(),e._metadataSearchDataSource&&e._updateMetadataSearchConfiguration()}}},e.prototype._hideScopingControl=function(){this._searchInstrumenter.setProps({scopingControl:Object(i.__assign)(Object(i.__assign)({},this._searchInstrumenter.props.scopingControl),{activeScopeId:void 0,scopes:void 0})})},e.prototype._configureMetadataSearch=function(){var e=this;this._metadataSearchDataSource&&(this._metadataSearchDataSource.updateMetadataSearchConfig=function(t){e._metadataSearchDataSource.isMetadataSearchMode=e._metadataSearchDataSource.isMetadataSearchResultPage(e._getViewParams())||t,e._updateMetadataSearchConfiguration(),e._metadataSearchDataSource.isMetadataSearchMode?t&&e._setFocusSearchBox():e._isScopeControlSupported()&&_(e._getScopingControlConfig(),e._searchInstrumenter)},this._metadataSearchDataSource.isMetadataSearchMode=this._metadataSearchDataSource.isMetadataSearchResultPage(this._getViewParams()),this._updateMetadataSearchConfiguration())},e.prototype._hideMetadataSearchButton=function(){var e;null===(e=this._searchInstrumenter)||void 0===e||e.setProps({filterButtonConfig:void 0})},e.prototype._showMetadataSearchButton=function(){var e,t=this;null===(e=this._searchInstrumenter)||void 0===e||e.setProps({filterButtonConfig:{onClick:function(e){var n=e||window.event;n?(n.preventDefault(),t._teachingBubbleProvider?t._showMetadataSearchTeachingBubble(n):t._openMetadataSearchForm(n.type)):t._openMetadataSearchForm()},ariaLabel:I.c,title:I.c}})},e.prototype._showMetadataSearchTeachingBubble=function(e){var t=this,n={campaignGuid:"b8ceb79a-73e5-4e1d-8df8-27dedb514597",flag:{Fallback:!0}},a=e.target,r=e.type,o=new s.e({name:"SearchBox.ShowMetadataSearchTeachingBubble"});this._teachingBubbleProvider.shouldBubbleBeAdded(n,!1).then(function(e){var s;e?(s={isVisible:e,onDismiss:function(){t._teachingBubbleProvider.markBubbleAsDismissed(n),t._openMetadataSearchForm(r)},target:a,listTemplate:t._listTemplate},Object(F.render)(R.createElement(N,Object(i.__assign)({},s)),B),t._teachingBubbleProvider.markBubbleAsSeen(n),o.end({resultType:c.e.Success})):(j(),t._openMetadataSearchForm(r),o.end({resultType:c.e.Success,resultCode:"AlreadyShowed"}))}).catch(function(e){j(),t._openMetadataSearchForm(r),o.end({resultType:c.e.Failure,error:e.message})})},e.prototype._openMetadataSearchForm=function(e){var t=this;this._metadataSearchDataSource.isMetadataSearchMode=!0,this._updateMetadataSearchConfiguration(),this._setFocusSearchBox(),"keydown"===e&&setTimeout(function(){return t._setFocusSearchBox()},0)},e.prototype._updateMetadataSearchConfiguration=function(){var e,t,n=this,a=null===(e=this._scopingControlDataSource)||void 0===e?void 0:e.getActiveScope(),i=null===(t=this._scopingControlDataSource)||void 0===t?void 0:t.getActiveScope.bind(this._scopingControlDataSource),r=this._isMetadataSearchSupportedScope(a),o=this._isMetadataSearchSupported&&r;this._runInShellSearch(function(e){e.SetProviderConfigUpdaters(n._searchBoxDataSource.getProviderConfigUpdaters(i,n._getViewParams))}),o?this._metadataSearchDataSource.isMetadataSearchMode?(this._hideScopingControl(),this._hideMetadataSearchButton()):this._searchBoxDataSource.isSearchResultsPage()?this._hideMetadataSearchButton():this._showMetadataSearchButton():this._hideMetadataSearchButton()},e.prototype._setFocusSearchBox=function(){this._resources.consumeAsync(this._searchBoxDataSource.getSuiteNavProviderKey()).then(function(e){e.getO365Shell().then(function(e){e.Search.FocusSearchBox()})})},e.prototype._setSearchInstrumenterProps=function(){this._searchBoxDataSource.getSearchInstrumenterProps&&this._searchInstrumenter&&this._searchInstrumenter.setProps(this._searchBoxDataSource.getSearchInstrumenterProps())},e.prototype._triggerSearchBoxReconfiguration=function(){this._runInShellSearch(function(e){return e.RecomputeSearchBoxConfiguration()})},e.prototype._logScopeChange=function(e,t){if(!this._scopingControlDataSource)throw new Error("Scoping control is not supported.");var n=this._scopingControlDataSource.getInitialScope(),a=this._scopingControlDataSource.getScopeControlScenario(n,this._searchBoxDataSource.isSearchResultsPage());this._engagement.logData({name:"SuiteNavSearchBox.ScopeChanged",isIntentional:!0,scenario:a,extraData:{initialScope:n.id,targetScope:e.id,searchTriggered:t},privacyClassification:g.t.optionalDiagnostic})},e.dependencies={resources:d.r,engagement:A.e,searchBoxDataSource:S.e,searchBoxConfig:v.e,scopingControlDataSource:y.optional,metadataSearchDataSource:U.e.optional,bootOptions:T.e.optional,teachingBubbleProvider:D.s.optional},e}(),z=(t.default=V,Object(l.r)("SearchBoxProvider",V))},1479:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return P}),n.d(t,"clearCache",function(){return T}),n.d(t,"isProvisioning",function(){return U});var a=n(1055),i=n(105),r=n(103),o=n(486),s=n(1333),c=n(1235),d=n(21),l=n(842),u=n(46),f=function(){function e(){}return e.prototype.OnFlexPaneVisibilityChanged=function(e){try{return O365Shell.FlexPane.OnFlexPaneVisibilityChanged(e)}catch(e){u.e.log(e,"FlexPaneWrapper","OnFlexPaneVisibilityChanged")}},e.prototype.OpenFlexPaneForProvider=function(e){try{O365Shell.FlexPane.OpenFlexPaneForProvider(e)}catch(e){u.e.log(e,"FlexPaneWrapper","OpenFlexPaneForProvider")}},e.prototype.CloseFlexPaneForProvider=function(e){try{O365Shell.FlexPane.CloseFlexPaneForProvider(e)}catch(e){u.e.log(e,"FlexPaneWrapper","CloseFlexPaneForProvider")}},e.prototype.RemoveOnFlexPaneVisibilityChanged=function(e){try{O365Shell.FlexPane.RemoveOnFlexPaneVisibilityChanged(e)}catch(e){u.e.log(e,"FlexPaneWrapper","RemoveOnFlexPaneVisibilityChanged")}},e}(),p=function(){function e(){}return e.prototype.OnLinkClick=function(e){try{O365Shell.Navigation.OnLinkClick(e)}catch(e){u.e.log(e,"NavigationWrapper","OnLinkClick")}},e.prototype.OnHamburgerButtonClick=function(e){try{O365Shell.Navigation.OnHamburgerButtonClick(e)}catch(e){u.e.log(e,"NavigationWrapper","OnHamburgerButtonClick")}},e.prototype.RemoveOnLinkClick=function(e){try{O365Shell.Navigation.OnLinkClick(e)}catch(e){u.e.log(e,"NavigationWrapper","RemoveOnLinkClick")}},e.prototype.EnterAccessibilityLoopInShell=function(){try{O365Shell.Navigation.EnterAccessibilityLoopInShell()}catch(e){u.e.log(e,"NavigationWrapper","EnterAccessibilityLoopInShell")}},e.prototype.ReverseEnterAccessibilityLoopInShell=function(){try{O365Shell.Navigation.ReverseEnterAccessibilityLoopInShell()}catch(e){u.e.log(e,"NavigationWrapper","ReverseEnterAccessibilityLoopInShell")}},e.prototype.SetForwardAccessibilityLoopOutsideHeaderElementId=function(e){try{O365Shell.Navigation.SetForwardAccessibilityLoopOutsideHeaderElementId(e)}catch(e){u.e.log(e,"NavigationWrapper","SetForwardAccessibilityLoopOutsideHeaderElementId")}},e.prototype.SetReverseAccessibilityLoopOutsideHeaderElementId=function(e){try{O365Shell.Navigation.SetReverseAccessibilityLoopOutsideHeaderElementId(e)}catch(e){u.e.log(e,"NavigationWrapper","SetReverseAccessibilityLoopOutsideHeaderElementId")}},e}(),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._flexPane=new f,t._navigation=new p,t}return Object(d.__extends)(t,e),Object.defineProperty(t.prototype,"FlexPane",{get:function(){return this._flexPane},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Navigation",{get:function(){return this._navigation},enumerable:!1,configurable:!0}),t}(l.e),_=m,h=n(784),b=n(56),g=n(617),v=n(5),y=n(1272),S=n(748),D=n(415),I=n(268),x=n(76),C=n(95),O=n(1331),w="Data",E="CacheDate",A="CacheVersion",L="CachedThisSession",k=new i.e("odSuiteNav",r.e.local),M=function(){function e(e,t){this._dataSource=t.dataSource,this._capabilities=this._dataSource.getCapabilities(),this._cssLoaded=!1}return Object.defineProperty(e.prototype,"suiteNavPlaceholder",{get:function(){return this._suiteNavPlaceholder},set:function(e){this._suiteNavPlaceholder||(this._suiteNavPlaceholder=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"accountSwitchCallback",{get:function(){return this._dataSource.accountSwitchCallback},enumerable:!1,configurable:!0}),e.prototype.getCapabilities=function(){return this._capabilities},e.prototype.clearCachedPromise=function(){this._modelPromise=void 0,this._shellSignal=void 0},e.prototype.getRenderSetting=function(e){return this._dataSource.getRenderSetting?this._dataSource.getRenderSetting(e):null},e.prototype.loadData=function(e){return this._loadModel(e).then(function(e){return e.data})},e.prototype.getO365Shell=function(){if(!this._capabilities.supportsRealSuiteNav)throw new Error("getO365Shell is only supported if supportsRealSuiteNav capability is true.");var e=this._shellSignal;if(!e){e=new a.e;var t=new x.e({name:"SuiteNavProvider.GetO365Shell"});this._getSuiteNavShell(e),e.getPromise().then(function(){t.end({resultType:C.e.Success})},function(e){t.end(R({error:e}))}),this._shellSignal=e}return e.getPromise()},e.prototype.getMailUrl=function(){return this._loadModel().then(function(e){var t=e&&e.data&&e.data.WorkloadLinks;if(t)for(var n=0,a=t;n<a.length;n++){var i=a[n];if(i&&i.Id===h.e.MAIL)return i.Url}})},e.prototype._getSuiteNavShell=function(e,t){var n=this;this._loadModel().then(function(a){!n._cssLoaded&&a.cssUrl&&(D.e.loadStylesheet(a.cssUrl),n._dataSource.onCssLoad&&n._dataSource.onCssLoad(a),n._cssLoaded=!0);var i=a.requireConfig,r=i&&i.paths;t&&r&&(r.shellcore+=".js?odb_cb="+(new Date).toISOString()),O.e.addConfig(a.requireConfig),n._requestShellCore().then(function(t){e.complete(t)},function(t){(t=R({error:t}))&&"RequireError"===t.resultCode&&n._isDataFromCache?(I.e.logData({name:"SuiteNavProvider.O365ShellCacheFailed"}),n._getSuiteNavShell(e)):n._hasRetriedShell?e.error(t):(n._hasRetriedShell=!0,n._cssLoaded=!1,I.e.logData({name:"SuiteNavProvider.O365ShellRetry"}),n._getSuiteNavShell(e,!0))})})},e.prototype._requestShellCore=function(){var e=this,t=new a.e,n=requirejs.toUrl("shellcore");return window.require(["shellcore"],function(){!function(){var e=window._o365su;if(e&&e.b)for(var t=0,n=["ThrowOnNull","ThrowOnUndefined","ThrowOnNullOrUndefined","ThrowOnNullOrEmpty","ThrowOnNullOrEmptyArray"];t<n.length;t++){var a=n[t];H(e.b,a)}}();var e=new _;e.Exists()?t.complete(e):t.error(R({error:{message:"O365Shell not defined after require() succeeded"},resultCode:"O365ShellNotDefined",extraData:{shellUrl:n}}))},function(a){e._capabilities.supportsCaching&&T(),requirejs.undef("shellcore"),e._modelPromise=void 0,t.error(R({error:a,resultCode:"RequireError",extraData:{shellUrl:n}}))}),t.getPromise()},e.prototype._loadModel=function(e){var t=this;if(!e&&this._modelPromise)return this._modelPromise;var n,a,o=this._capabilities.supportsCaching,s=this._dataSource,c=C.e.Failure,d=x.e.instrumentPromise({name:"SuiteNavProvider.LoadData"},function(){return new S.t(function(a,d){var l,u,f;!e&&o&&t._isCacheValid()&&(l=k.getValue(w)),l&&l.data?(I.e.logData({name:"SuiteNavProvider.DataFromCache"}),s.updateDataForCurrentPage&&s.updateDataForCurrentPage(l.data),o&&(u=k.getValue(L,r.e.session),f=Date.parse(k.getValue(E)),i.e.hasStorageType(r.e.session)&&!u||Date.now()-f>=432e5)&&(I.e.logData({name:"SuiteNavProvider.RefreshCache"}),s.loadData().done(F)),t._isDataFromCache=!0,a(l)):(t._isDataFromCache=!1,e&&I.e.logData({name:"SuiteNavProvider.ForceUpdateData"}),I.e.logData({name:"SuiteNavProvider.DataFromServer"}),s.loadData(e).done(function(e){e?e.data?(o&&!U(e)&&F(e),a(e)):(n="NoModelData",d("Model with no data returned")):(n="NoModel",d("No model returned"))},function(e){S.t.isCanceled(d)?(n="Canceled",c=C.e.ExpectedFailure):n="ServerLoadFailure",d(e)}))})},null,function(e){return S.t.isCanceled(e)&&(c=C.e.ExpectedFailure,n="Canceled"),{resultType:c,resultCode:n||"Other",error:e}});return(a=Object(y.e)())?this._modelPromise=S.t.all({suiteNavModel:d,theme:a.loadThemeSlotsMap()}).then(function(e){var t=e.suiteNavModel,n=e.theme,a=t&&t.data,i=t&&t.hasCobranding,r=a&&a.UseSPOBehaviors,o=Object(v.isFeatureEnabled)(v.SuiteNavPrefersTenantTheme),s=n&&n.suiteBarBackground;return!(s&&a&&r)||i&&o||(a.ThemeColors=[s,n.primaryText,s,n.suiteBarText,n.suiteBarDisabledText,n.topBarBackground,n.topBarText,n.topBarHoverText,n.primaryBackground,n.themeLighterAlt,n.dialogBorder]),t}):this._modelPromise=d,this._modelPromise},e.prototype._isCacheValid=function(){var e=k.getValue(w),t=k.getValue(A),n=Date.parse(k.getValue(E)),a=this._capabilities.supportsRealSuiteNav,i=this._dataSource,r=e&&e.data&&(!a||e.requireConfig)&&5===t&&e.userIdentifier===i.getUserIdentifier()&&e.cacheToken===i.getCacheToken()&&!isNaN(n)&&Date.now()-n<864e5;if(!r){var o={model:!!e,"model.data":e&&!!e.data,"model.requireConfig":e&&!!e.requireConfig,supportsRealSuiteNav:a,oldVersion:t,CACHE_VERSION:5,userIsIdentical:e&&e.userIdentifier===i.getUserIdentifier(),cacheToken:e&&e.cacheToken,dataSourceCacheToken:i.getCacheToken(),cacheDate:!isNaN(n),expired:Date.now()-n>=864e5};I.e.logData({name:"SuiteNavCacheDataInvalid",extraData:o})}return r},e}(),P=(t.default=M,Object(v.isFeatureEnabled)(v.UnifiedSuiteNavComponent)?Object(o.r)("SuiteNavProvider",s.e,{dataSource:g.e}):Object(o.r)("SuiteNavProvider",M,{dataSource:b.h}));function T(){k.remove(w),k.remove(E),k.remove(A),k.remove(L,r.e.session)}function U(e){var t=e&&e.data&&e.data.WorkloadLinks;return!!t&&t.some(function(e){return e&&!e.Url})}function F(e){k.setValue(w,e),k.setValue(E,new Date),k.setValue(A,5),k.setValue(L,!0,r.e.session)}function H(e,t){var n=e[t];"function"==typeof n&&(e[t]=function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];try{return n.apply(this,e)}catch(e){c.e.logData({message:e&&e.message||"",stack:e&&e.stack||"",type:t})}})}function R(e){var t=e.error;if(t&&t.resultCode)return t;var n=C.e.Failure;return S.t.isCanceled(t)&&(n=C.e.ExpectedFailure,e.resultCode="Canceled"),{resultType:n,resultCode:e.resultCode||"Other",error:t,extraData:e.extraData}}},1497:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return F});var a=n(21),i=n(486),r=n(1178),o=n(897),s=n(132),c=n(381),d=n(59),l=n(376),u=n(1056),f=n(243),p=n(75),m=n(219),_=n(54),h=n(1151),b=n(56),g=n(451),v=n(340),y=n(43),S=n(1109),D=n(433),I=n(215),x=n(31),C=n(57),O=n(1060),w=n(127),E=n(1201),A=n(476),L=n(231),k=n(230),M=n(1070),P=n(28),T=n(1124),U=function(){function e(e,t){this._listItemBuilder=t.listItemBuilder,this._listItemResultProcessor=t.listItemResultProcessor,this._itemTaskObserverType=t.itemTaskObserverType,this._urlDataSource=t.urlDataSource,this._microServiceDataSource=t.microServiceDataSource,this._microServiceDataSourceStore=t.microServiceDataSourceStore,this._listContext=t.listContext,this._onePageContext=t.onePageContext,this._pageContext=t.pageContext}return e.prototype.updateFromResponse=function(e){var t=this;return function(n){var i=new t._itemTaskObserverType,r=e.itemSetKey,o=e.serverData,s=e.isItemSetRequest,p=n(Object(l.e)(function(e){var t=e.demandItemFacet(k.e,r),n=t.webAbsoluteUrl,a=t.listFullUrl,i=M.e.serialize({webAbsoluteUrl:n,listFullUrl:a}),o=e.demandItemFacet(P.At,i);return{storeKey:e.demandItemFacet(f.t,r),pageContextKey:i,pageContext:o}})),_=p.storeKey,h=p.pageContext,b=p.pageContextKey;if(void 0!==_){var g=[_],v=_.key;s&&(o&&S.e.updateListContext(o,t._listContext),O.e&&t._onePageContext&&n(function(e,t,n,i){return function(r){var o;i.refreshClientForm=!0,t&&t.listUrl&&i.listId&&t.listId&&i.listId.toUpperCase()===t.listId.toUpperCase()?(w.e(e,t),n&&r(Object(E.e)({items:(o={},o[C.r]=Object(a.__assign)({},C.f.pack({itemKey:n})),o)}))):(e.listUrl=i.listUrl,e.listId=i.listId,e.listTitle=i.listTitle,e.listBaseTemplate=i.listTemplateType),Object(A.t)(void 0,{listId:Object(L.a)(i.listId)}),e.serverRequestPath=void 0}}(t._pageContext,h,b,t._listContext)));var y=t._listItemResultProcessor.processResponse({response:o,pageContext:h,requestKey:v,observer:i}).listRootItemKey;if(s){var U=t._processRootFolder({response:o,requestKey:v,observer:i,isItemSetRequest:s,pageContext:h});U&&g.push(U.item)}var F=o.ListData&&o.ListData.Row||[],H=t._microServiceDataSourceStore.getOrCreateMicroServiceDataSource(y);if(H&&o.ListSchema){var R={data:o.ListSchema,allowCookies:!1};H.setBaseInfo(R),t._microServiceDataSource.setBaseInfo(R)}for(var N=o.ListSchema&&"TRUE"===o.ListSchema.Collapse,B=0,j=o.SpotlightInfo&&o.SpotlightInfo.Items&&o.SpotlightInfo.Items.Row||[];B<j.length;B++){var V=j[B],z=t._listItemBuilder.getItemResult({microServiceDataSource:H,itemFromServer:Object(a.__assign)({},V),requestKey:v,queryType:d.e.Files,supportsNestedGroups:!1,isItemDataOnly:!s,groupBy:[],observer:i}).item;g.push(z)}if(!N)for(var G=0,K=F;G<K.length;G++){var W=K[G];z=t._listItemBuilder.getItemResult({microServiceDataSource:H,itemFromServer:Object(a.__assign)({},W),requestKey:v,queryType:d.e.Files,supportsNestedGroups:!1,isItemDataOnly:!s,groupBy:[],observer:i,pageContext:h}).item,g.push(z)}i.flush();for(var q=new u.e,Q=function(e){var t,r,o=i.getItem(e);if(o&&!o.isPlaceholder){var s=Object(m.d)(e.key),d=n(Object(l.e)(function(e){var t=e.demandItemFacet(c.e,C.r);return c.e.evaluate(t)(e,{viewParams:s,isNavigation:!1}).itemKey}));if(d){var u=D.n.serialize({itemKey:d});q.resolveItems({items:(t={},t[d]=Object(a.__assign)({},Object(I.e)().forFacet(x.l).thenInvalidate(u,D.e).pack()),t[u]=Object(a.__assign)({},D.e.pack(void 0)),t)});var f=n(Object(T.t)({itemKey:d}));if(f)for(var p=0,_=Object.keys(f);p<_.length;p++){var h=_[p];h!==d&&q.mapKeys({mappings:(r={},r[u]=D.n.serialize({itemKey:h}),r)})}}}},Y=0,J=g;Y<J.length;Y++)Q(J[Y]);n(q.execute())}}},e.prototype._processRootFolder=function(e){var t=e.response,n=e.requestKey,a=e.observer,i=e.pageContext,r=e.isItemSetRequest,o=t.ListData,s=t.ListSchema,c=(void 0===s?{}:s).Collapse,d=void 0===c?"FALSE":c;if(o){var l=o&&o.Row,u="";o.NextHref&&(u=(u=o.NextHref).replace("&View=".concat(_.e.Empty),""));var f="TRUE"===d,m=!f&&l?l.slice(0):[],b=this._urlDataSource.getKeyParams(n),g={id:b[p.t.idParamKey],folder:{childCount:m.length,children:m},nextRequestToken:u,PermMask:o.FolderPermissions,groups:f?l:null,isRootFolder:!1};if(Object(h.e)()){var v=o&&o.CurrentFolderProgId;g.ProgId=v}return this._listItemBuilder.getItemResult({requestKey:n,queryType:this._urlDataSource.getQueryType(b),itemFromServer:g,supportsNestedGroups:!1,isItemDataOnly:!r,observer:a,groupBy:[],pageContext:i})}},e}(),F=(t.default=U,Object(i.r)("LegacyItemCacheSPResponseHandler",U,{listItemBuilder:r.e,listItemResultProcessor:o.e,itemTaskObserverType:s.resourceKey,urlDataSource:b.v,microServiceDataSource:g.resourceKey,microServiceDataSourceStore:v.e,listContext:y.n,pageContext:y.i,onePageContext:y.a.optional}))},1499:function(e,t,n){"use strict";n.r(t),n.d(t,"SuiteNavDataUpdater",function(){return O}),n.d(t,"resourceKey",function(){return w});var a=n(21),i=n(1328),r=n(784),o=n(1276),s=n(139),c=n(651),d=n(486),l=n(368),u=n(43),f=n(44),p=n(111),m=n(0),_=n(119),h=n(5),b=n(279),g=n(268),v=n(112),y=n(922),S=n(1327),D=n(869),I=n(637),x=Object(h.isFeatureEnabled)(h.DocumentSettingPanel),C=m.e.isActivated("55d7c666-d509-4231-9bd7-fd3e8f76384d","05/25/2022","Use unique link id for list settings"),O=function(){function e(e,t){this._resources=t.resources,this._pageContext=this._resources?this._resources.consume(u.i):t.pageContext}return e.prototype.updateSuiteNavData=function(e){var t,o=this,c=Object(a.__assign)({},e.suiteNavData);this._suiteNavContext=e.suiteNavContext;var d=this._pageContext.isSPO;this._isODB=Number(this._pageContext.webTemplate)===_.t.mySite,c.CurrentMainLinkElementID=this._suiteNavContext.currentMainLinkElementID||this._suiteNavContext.workloadId,c.ActionsMap={};var l=this._resources?this._resources.consume(y.e.optional):void 0;l&&l.set(!!c.AdminLink);var u=this._resources?this._resources.consume(y.t.optional):void 0;if(u)for(var p=0,h=Object(a.__spreadArray)(Object(a.__spreadArray)([],c.AppsLinks||[],!0),c.WorkloadLinks||[],!0);p<h.length;p++){var b=h[p];if("ShellSites"===b.Id){u.set(b.Url||"");break}}if(d&&this._pageContext.isAnonymousGuestUser)try{var C={Text:this._pageContext.userDisplayName||c.UserDisplayName||"",Url:null},O=JSON.parse(c.ClientData);O.SignInLink=C,c.ClientData=JSON.stringify(O),c.SignOutLink=null,c.AboutMeLink=null,c.IsAuthenticated=!1,c.O365SettingsLink=null,c.UserDisplayName=null}catch(e){}else{if(c.ActionsMap[r.e.SIGN_OUT]=function(){g.e.logData({name:"SuiteNav.SignOut.Click"});try{delete localStorage["onedrive.autoredirect"]}catch(e){}return!0},d&&this._pageContext.isEmailAuthenticationGuestUser)c.CurrentWorkloadSettingsSubLinks=null,c.LogoNavigationUrl=null;else if(!m.e.isActivated("f8d47155-9b9a-4663-9477-800f8da227fa","02/11/2022","Remove links from Stream settings")&&(m.e.isActivated("a7eb44e0-dbbe-46e1-8c95-88cdab4c07d4","04/29/2022","Use SuiteNavLinkId to identify Stream")?(null===(t=this._pageContext.serverRequestPath)||void 0===t?void 0:t.indexOf("stream.aspx"))>=0:c.CurrentMainLinkElementID===r.e.STREAM))c.CurrentWorkloadSettingsSubLinks=null;else if(c.CurrentMainLinkElementID===r.e.CLIPCHAMP)c.CurrentWorkloadSettingsSubLinks=null,m.e.isActivated("58cb5355-9131-46cc-8f7c-c14359937b65","09/01/2022","File A Bug Link in Clipchamp")||(c.CurrentWorkloadHelpSubLinks=[{Id:r.e.FEEDBACK,Text:"File a bug",TargetWindow:"_blank",Url:"https://onedrive.visualstudio.com/Clipchamp/_workitems/create/Bug?templateId=d6e86c3f-9dad-4009-ae89-8c4d9fa3c03a&ownerId=3db7eb97-eeaf-4acc-9b12-ef8f53c9e9be"}]);else{var w=this._pageContext.listBaseType?Object(f.a)(this._pageContext.listBaseType):Object(f.i)(this._pageContext.listBaseTemplate);x&&(c.ActionsMap[r.e.LIBRARY_SETTINGS]=function(e){var t=e.resources.consume(v.e);return new(e.resources.injected(t.LaunchDocLibSettingPanelAction))({panelHeaderText:S.e,isEditSettingPanel:x,settingPanelProps:{classicSettingLink:o._getDocLibSettingLink()}}).execute(null),!1}),c.CurrentWorkloadSettingsSubLinks=this._getSettingsLinks(w)}if(this._isSiteInformationLinkEnabled()&&(c.ActionsMap[r.e.SITE_INFORMATION]=function(e){return Object(D.e)(e.resources,function(e){return e.LaunchSiteSettingsPanelAction}),!1},window.sessionStorage.getItem("_isRunningTABTest")&&(window._spLaunchSiteSettings=function(){Object(D.e)(o._resources,function(e){return e.LaunchSiteSettingsPanelAction})})),this._isHubSettingsLinkEnabled()&&(c.ActionsMap[r.e.HUB_SETTINGS]=function(e){return Object(D.e)(e.resources,function(e){return e.LaunchHubSettingsPanelAction}),!1},this._pageContext.isHubSite&&window.sessionStorage.getItem("_isRunningTABTest")&&(window._spLaunchHubSettings=function(){Object(D.e)(o._resources,function(e){return e.LaunchHubSettingsPanelAction})})),this._isChangeTheLookLinkEnabled()&&(c.ActionsMap[r.e.CHANGE_THE_LOOK]=function(e){return Object(D.e)(e.resources,function(e){return e.LaunchChangeTheLookPanelAction}),!1}),this._isSitePermissionsLinkEnabled()&&(c.ActionsMap[r.e.SITE_PERMISSIONS]=function(e){return Object(D.e)(e.resources,function(e){return e.LaunchSitePermissionsPanelAction}),!1}),this._isSiteDesignsLinkEnabled()){var E=function(){Promise.resolve(n.e(10).then(n.bind(null,1480))).then(I.e).then(function(e){e.SiteScriptProgressStateManager.getInstance({pageContext:o._pageContext}).triggerOpenPanelAction()})};c.ActionsMap[r.e.SITE_DESIGNS]=function(e){return E(),!1},window.sessionStorage.getItem("_isRunningTABTest")&&(window._spLaunchSiteDesignProgress=E)}this._shouldShowGroupifyLink()&&(c.ActionsMap.Groupify=function(e){return Object(D.e)(e.resources,function(e){return e.LaunchGroupifyPanelAction}),!1}),this._isGlobalNavSettingsPanelEnabled()&&(c.ActionsMap.GLOBALNAV_SETTINGS_SUITENAVID=function(e){return Object(D.e)(e.resources,function(e){return e.LaunchGlobalNavSettingsPanelAction}),!1}),this._isWebTemplatesGalleryEnabled()&&(c.ActionsMap.SuiteMenu_MenuItem_WebTempaltesGallery=function(e){var t;return g.e.logData({name:"SiteTemplates.Panel.Click​",webTemplateId:null===(t=o._pageContext)||void 0===t?void 0:t.webTemplate}),Object(D.e)(e.resources,function(e){return e.LaunchWebTemplatesGalleryAction}),!1},window.sessionStorage.getItem("_isRunningTABTest")&&(window._spLaunchWebTemplatesGallery=function(){Object(D.e)(o._resources,function(e){return e.LaunchWebTemplatesGalleryAction})})),this._isVivaConnectionsSettingsLinkEnabled()&&(c.ActionsMap[r.e.VIVA_CONNECTIONS]=function(e){var t=e.resources.consume(v.e);return new(e.resources.injected(t.LaunchVivaConnectionsSettingsPanelAction))({}).execute(null),!1}),!c.SignOutLink&&d||(c.SignOutLink.Url=Object(s.n)(this._pageContext)+"/_layouts/15/SignOut.aspx",c.SignOutLink.Text||(c.SignOutLink.Text=i.p)),c.UserDisplayName=this._pageContext.userDisplayName||c.UserDisplayName||this._pageContext.webTitle||null}if(c.FeedbackLink=null,this._suiteNavContext.firstRunScenarioType&&(c.CurrentWorkloadHelpSubLinks=[{Id:r.e.FIRSTRUN,Text:i.f,Url:"#"}],c.ActionsMap[r.e.FIRSTRUN]=function(e){return Object(D.e)(e.resources,function(e){return e.InvokeFirstRunExperienceAction}),!1}),d||(c.StringsOverride=c.StringsOverride||{},c.StringsOverride.l_ShellCore_O365_Text="SharePoint"),this._suiteNavContext.helpNamespace&&this._suiteNavContext.helpId?c.HelpLink.Url="https://o15.officeredir.microsoft.com/r/rlidOfficeWebHelp?p1=".concat(this._suiteNavContext.helpNamespace,"&clid=").concat(this._pageContext.currentLanguage,"&ver=").concat(d?"16":"19","&HelpId=").concat(this._suiteNavContext.helpId):c.HelpLink.Url="https://support.microsoft.com",!d){if(c.HelpLink){var A=this._suiteNavContext.helpIdOnPrem||"WSSEndUser",L=this._pageContext.currentLanguage;c.HelpLink.Url="https://support.office.com/client/results?helpid=".concat(A,"&NS=").concat("WSSEndUser","&lcid=").concat(L,"&SYSLCID=").concat(L,"&UILCID=").concat(L,"&Version=19")}c.ActionsMap[r.e.HELP]=function(){var e=window.open("","_blank","resizable=1,location=0,width=400,height=500");return e.opener=null,e.location.href=c.HelpLink.Url,!1}}c.HelpLink.Text||(c.HelpLink.Text=i.i);var k=Number(this._pageContext.webTemplate),M=k===_.t.mySite||k===_.t.mySiteHost;return c.UseSPOBehaviors=!M,c},e.prototype._getDocLibSettingLink=function(){return this._pageContext.webAbsoluteUrl+"/_layouts/15/listedit.aspx?List="+encodeURIComponent(this._pageContext.listId)},e.prototype._getSettingsLinks=function(e){var t,s=this,c=this._pageContext.webAbsoluteUrl,d=f.t.documentLibrary===Number(this._pageContext.listBaseTemplate),l=[];if(t=e&&x?{Id:r.e.LIBRARY_SETTINGS,Text:i.o,Url:"#",Hidden:!this._pageContext.listId,IsMySiteSettingLink:!1,ListPermissions:[p.e.manageLists]}:{Id:C?r.e.LIBRARY_SETTINGS:r.e.LIST_SETTINGS,Text:e?i.o:i.s,Url:c+"/_layouts/15/listedit.aspx?List="+encodeURIComponent(this._pageContext.listId),Hidden:!this._pageContext.listId,IsMySiteSettingLink:!1,ListPermissions:[p.e.manageLists]},this._suiteNavContext.currentMainLinkElementID===r.e.LISTS){if(Object(h.isFeatureEnabled)(h.EnterpriseListsRecycleBinIntegration)&&!m.e.isActivated("341F47DF-82E0-462B-885C-C8E12E8B9494","Add Recycle Bin to Lists Home")){var u={Id:r.e.LIBRARY_SETTINGS,Text:i.d,Url:c+"/_layouts/15/"+(this._pageContext.isSiteAdmin?"AdminRecycleBin.aspx":"RecycleBin.aspx")+"?view=5&env=WebViewList"};l.push(u)}return Object(b.n)(this._pageContext)&&l.push(t),l}if(this._suiteNavContext.showMySiteSettings||this._suiteNavContext.showTrimmedSettings){var _=this._pageContext.listPermsMask||p.e.fullMask,g=this._pageContext.webPermMasks,v=!1,y=this._pageContext.MenuData&&this._pageContext.MenuData.SettingsData;if(y&&!this._isODB){for(var S=this._suiteNavContext.showTrimmedSettings&&!t.Hidden&&p.e.hasAny(_,t.ListPermissions),D=function(e){return{Id:e.Id,Text:e.Text,Url:e.Url}},I=0,O=y;I<O.length;I++){var w=O[I];w?(v&&(l.push(null),v=!1),w.Id===t.Id?S=!1:S&&w.Id===r.e.SITE_SETTINGS&&(l.push(D(t)),S=!1),l.push(D(w))):v=!0}S&&l.push(D(t)),Object(h.isFeatureEnabled)(h.ShowSharepointRestoreLink)&&this._pageContext.isSiteAdmin&&d&&l.push(D({Id:"Document_Library_Restore",Text:i.l,Url:"?p=18"}))}else for(var E=0,A=[{Id:r.e.ADD_APP,Text:i.e,Url:c+"/_layouts/15/addanapp.aspx",IsMySiteSettingLink:!0,WebPermissions:[p.e.manageLists,p.e.manageSubwebs],Hidden:this._isODB},{Id:r.e.SITE_CONTENTS,Text:i._,Url:c+"/_layouts/15/viewlsts.aspx",IsMySiteSettingLink:!0,WebPermissions:[p.e.viewFormPages],Hidden:this._isODB},null,t,{Id:r.e.SITE_SETTINGS,Text:i.v,Url:c+"/_layouts/15/settings.aspx",IsMySiteSettingLink:!0,WebPermissions:o.e.siteSettingsPermissions.concat(),Hidden:this._isODB}];E<A.length;E++){var L=A[E];v=v||!L,L&&!L.Hidden&&(this._suiteNavContext.showMySiteSettings?L.IsMySiteSettingLink:p.e.hasAny(g,L.WebPermissions)||p.e.hasAny(_,L.ListPermissions))&&(v&&(l.push(null),v=!1),l.push({Id:L.Id,Text:L.Text,Url:L.Url}))}}return this._isGlobalNavSettingsPanelEnabled()&&l.push({Id:"GLOBALNAV_SETTINGS_SUITENAVID",Text:i.n,Url:"#"}),this._isHubSettingsLinkEnabled()&&l.push({Id:r.e.HUB_SETTINGS,Text:i.r,Url:"#"}),this._isSiteInformationLinkEnabled()&&(l=l.filter(function(e){return!e||e.Id!==r.e.SITE_SETTINGS})).push({Id:r.e.SITE_INFORMATION,Text:i.h,Url:"#"}),this._isSitePermissionsLinkEnabled()&&l.push({Id:r.e.SITE_PERMISSIONS,Text:i.b,Url:"#"}),this._isWebTemplatesGalleryEnabled()&&l.push({Id:"SuiteMenu_MenuItem_WebTempaltesGallery",Text:i.y,Url:"#"}),this._isODB&&(this._pageContext.isSiteAdmin&&(Object(h.isFeatureEnabled)(h.OneDriveSettings)&&l.push({Id:"OneDrive_Settings",Text:i.c,Url:c+"/_layouts/15/onedrive.aspx?p=22"}),l.push({Id:"OneDrive_Restore",Text:i.u,Url:c+"/_layouts/15/onedrive.aspx?p=18"})),Object(h.isFeatureEnabled)(h.DownloadDebugLogs)&&l.push({Id:"Download_Logs",Text:"Download Logs",Action:function(){return Object(a.__awaiter)(s,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(45).then(n.bind(null,1450))];case 1:return(0,e.sent().downloadDebugLogs)(),[2]}})})}})),this._isSiteAnalyticsLinkEnabled()&&l.push({Id:"Site_Analytics",Text:i.m,Url:c+"/_layouts/15/siteanalytics.aspx"}),this._isChangeTheLookLinkEnabled()&&l.push({Id:r.e.CHANGE_THE_LOOK,Text:i.t,Url:"#"}),this._isSiteDesignsLinkEnabled()&&l.push({Id:r.e.SITE_DESIGNS,Text:i.g,Url:"#"}),this._shouldShowGroupifyLink()&&l.push({Id:"Groupify",Text:i.a,Url:"#"}),this._isVivaConnectionsSettingsLinkEnabled()&&l.push({Id:r.e.VIVA_CONNECTIONS,Text:this._isVivaConnectionsSettingsPreviewTagEnabled()?i.D:i.S,Url:"#"}),l.length>0?l:null},e.prototype._isSiteAnalyticsLinkEnabled=function(){return!this._isODB&&Object(h.isFeatureEnabled)(h.SiteAnalyticsV3)},e.prototype._isSiteInformationLinkEnabled=function(){var e=Number(this._pageContext.webTemplate)===_.t.mySite||Number(this._pageContext.webTemplate)===_.t.mySiteHost;return p.e.hasPermission(this._pageContext.webPermMasks,p.e.manageWeb)&&(Object(s.r)(this._pageContext)||!e)},e.prototype._isHubSettingsLinkEnabled=function(){return this._pageContext.isSiteAdmin&&this._pageContext.isHubSite},e.prototype._isSitePermissionsLinkEnabled=function(){var e=Number(this._pageContext.webTemplate);return!this._isODB&&(!this._pageContext.isAnonymousGuestUser&&!this._pageContext.isExternalGuestUser||p.e.hasPermission(this._pageContext.webPermMasks,p.e.manageWeb))&&(Object(h.isFeatureEnabled)(h.PermUpdateForChannelSIte)||e!==_.t.teamChannel)},e.prototype._isChangeTheLookLinkEnabled=function(){var e=Number(this._pageContext.webTemplate);return this._pageContext.modernThemingEnabled&&p.e.hasPermission(this._pageContext.webPermMasks,p.e.applyThemeAndBorder)&&e!==_.t.mySite&&e!==_.t.mySiteHost},e.prototype._hasApplyTemplatePermission=function(){return this._pageContext.isSiteAdmin||p.e.hasPermission(this._pageContext.webPermMasks,{High:2147483647,Low:4294705151})},e.prototype._isSiteDesignsLinkEnabled=function(){if(!this._isWebTemplatesGalleryEnabled()&&this._hasApplyTemplatePermission()){var e=Number(this._pageContext.webTemplate);return e===_.t.group||e===_.t.sitePagePublishing||"STS#3"===this._pageContext.webTemplateConfiguration}return!1},e.prototype._isWebTemplatesGalleryEnabled=function(){return Object(h.isFeatureEnabled)(h.EnableWebTemplatesGallery)&&this._hasApplyTemplatePermission()&&Object(s.o)({webTemplateConfiguration:this._pageContext.webTemplateConfiguration})},e.prototype._isGlobalNavSettingsPanelEnabled=function(){var e=this._pageContext;return Object(h.isFeatureEnabled)(h.WEXMultipleHomeSitesGlobalNav)?Object(s.s)(e)&&e.isCurrentSiteAHomeSite&&p.e.hasPermission(e.webPermMasks,p.e.manageWeb):Object(s.s)(e)&&e.companyPortalReference&&e.companyPortalReference.SiteId&&e.siteId.indexOf(e.companyPortalReference.SiteId)>=0&&p.e.hasPermission(e.webPermMasks,p.e.manageWeb)},e.prototype._shouldShowGroupifyLink=function(){return e=this,Object(h.isFeatureEnabled)(h.GroupifyFromModernPages)&&e._pageContext.isSPO&&e._pageContext.isSiteAdmin&&!e._pageContext.restrictedToRegion&&"/"!==e._pageContext.siteServerRelativeUrl&&e._pageContext.siteServerRelativeUrl===e._pageContext.webServerRelativeUrl&&Number(e._pageContext.webTemplate)===_.t.teamSite&&!e._pageContext.groupId&&!e._pageContext.isGroupifyDisabled&&(m.e.isActivated("616A3856-3AB2-4319-BB53-F25B63B5FC02","10/03/2020","Respect isGroupifyMenuButtonFeatureOff in Suite Nav")||!e._pageContext.isGroupifyMenuButtonFeatureOff);var e},e.prototype._isVivaConnectionsSettingsLinkEnabled=function(){var e,t="false"!==(null===(e=this._pageContext.farmSettings)||void 0===e?void 0:e.ExternalService_vivaconnectionsenabled),n=m.e.isActivated("30DBB208-E98E-41EF-B53E-6A7DDA4EE2AD")?p.e.hasItemPermission({permissions:this._pageContext.listPermsMask},p.e.editListItems):p.e.hasPermission(this._pageContext.webPermMasks,p.e.editListItems);return t&&Object(h.isFeatureEnabled)(h.VivaConnectionsGA)&&Object(c.t)(this._pageContext)&&n},e.prototype._isVivaConnectionsSettingsPreviewTagEnabled=function(){return!Object(h.isFeatureEnabled)(h.VivaConnectionsPreviewTagRemoval)},e}(),w=Object(d.r)("SuiteNavDataUpdater",O,{resources:l.r});t.default=O},1500:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return p}),n.d(t,"deferredSetup",function(){return m});var a=n(101),i=n(368),r=n(21),o=n(1276),s=n(170),c=n(486),d=n(646),l=Object(c.o)("SuiteNavDataSourceV2",o.e,Object(r.__assign)({pageContext:s.e},{prefetchCache:d.e.optional})),u=n(456),f=n(617),p=new i.t({name:"SuiteNavDeferredSetup",factory:{dependencies:{},create:function(){return{instance:m}}}}),m=function(e,t){var i=e.rumone,r=e.resources,o=e.suiteNavCapabilities,s=e.suiteNavContext,c=e.onSuiteNavLoaded,d=e.setDataParams,p=e.onAfterSetData,m=e.deferredSetupCallback,_=e.isEarlySuiteNav,h=e.suiteNavDataUpdaterKey,b=e.suiteNavProviderKey,g=e.searchBoxProviderKey;return h&&b&&r.consumeAsync(h).then(function(e){var h,v,y=new(r.consume(l))({suiteNavCapabilities:o,suiteNavContext:s,suiteNavDataUpdater:e,suiteNavDataSourceBasic:r.consume(u.e.optional)});r.isExposed(f.e)||r.expose(f.e,y);var S=r.consumeAsync(b).then(function(e){return h=e,e.getO365Shell()}).then(function(e){return v=e,null==c||c(v),n.e(41).then(n.bind(null,1452)),m&&m({resources:r,shell:v}),v.GetResourceLoader().loadAll(),h.trySetDataAfterInitialRender(v,d||{})}).then(function(e){e&&(i.mark("Bootstrapper.SuiteNav.CompleteRendered"),i.logRUMOneForDeferredControl("SuiteNav",a.n.now())),null==p||p(v,e)}),D=g?r.consumeAsync(g).then(function(e){e.configureSearchBox(t)}):Promise.resolve();return _?Promise.all([S,D]).then(function(){}):void 0})}},1505:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return E});var a=n(21),i=n(40),r=n(1227),o=n(54),s=n(160),c=n(46),d=n(748),l=n(474),u=n(48),f=n(73),p=n(36),m=n(706),_=n(439),h=n(132),b=n(155),g=n(154),v=n(247),y=n(100),S=n(216),D=n(43),I=n(486),x=new(n(368).t)({name:"ShortcutUpdater.key",loader:new I.t(function(){return n.e(14).then(n.bind(null,1455)).then(function(e){return e.resourceKey})})}),C=n(619),O=n(201),w=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._shortcutResolverQueue=new l.e,a._pageContext=n.pageContext,a._apiUrlHelper=n.apiUrlHelper,a._itemUrlHelper=n.itemUrlHelper,a._identityDataSource=n.identityDataSource,a._dataRequestor=new(a.scope.attached(n.dataRequestorType))({qosName:"ShortcutLinkDataSource"}),a}return Object(a.__extends)(t,e),t.isSharePointUrl=function(e){var t=new u.t(e).getHost().toLowerCase();return t.indexOf("spoppe.com")>=0||t.indexOf("sharepoint.com")>=0||t.indexOf("sharepoint.cn")>=0},t.prototype.isInternal=function(e,t){if(t&&t!==o.e.Empty&&/@"^[{|\(]?[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}[\)|}]?$/i.test(t))return!0;if(!this._itemUrlHelper.getUrlParts({path:e}).isCrossDomain)return!0;var n=new u.t(e).getHost().toLowerCase(),a=new u.t(this._pageContext.webAbsoluteUrl).getHost().toLowerCase();if(n===a)return!0;var i=void 0,r=/(?:(.+?)(-my)??(\.[^\/]*))|(?:([^\.]*)$)/i.exec(a);if(!r)return!1;if(void 0!==r[2])i=r[1]+r[3];else if(void 0!==r[3])i=r[1]+"-my"+r[3];else if(void 0!==r[4])return!1;return n===i},t.prototype.createShortcut=function(e,t,n){var a=this._itemUrlHelper.getItemUrlParts(e),i=this._apiUrlHelper.build().webByItemUrl(a).methodWithAliases("GetFolderByServerRelativePath",{decodedUrl:a.serverRelativeItemUrl}).segment("Files").methodWithAliases("AddUsingPath",{decodedUrl:t,overwrite:!1});return this._dataRequestor.getData({url:i.toString(),parseResponse:function(e){return e},qosName:"CreateShortcut",method:"POST",additionalPostData:this._getCreateShortcutPostBody(n)}).then(void 0,function(e){var t=e.code;return/^\-2130575257,/.test(t)?d.t.wrapError(_.e.ShortcutErrors.NewFileCreationFileAlreadyExistsError):/^\-2130575245,/.test(t)?d.t.wrapError(_.e.ShortcutErrors.InvalidCharacterError):d.t.wrapError(_.e.ShortcutErrors.UnknownError)})},t.prototype.getShortcutTargetData=function(e){var n,a,i=this,r=e.url,c=e.avoidGetFileByUrlCall,l=e.parentKey,u=e.targetSiteUrl,f=d.t.resolve(void 0);if(u)n=new s.t({webAbsoluteUrl:u}).build(),f=this._getAuthTokenForSite(u),a=decodeURIComponent(r);else{var p=l?this._itemUrlHelper.getItemUrlParts(l):this._itemUrlHelper.getUrlParts({path:r});l&&p.isCrossDomain?(n=new s.t({webAbsoluteUrl:p.fullWebUrl}).build(),f=this._getAuthToken({parentKey:l})):n=this._apiUrlHelper.build(),a=p.fullItemUrl}return n=n.method("SP.Utilities.ShortcutLink.GetShortcutLink",a),f.then(function(e){return i._dataRequestor.getData({url:n.toString(),qosName:"GetShortcutTargetData",method:"GET",noRedirect:!0,authToken:e}).then(function(e){return{url:e.d.url,siteId:e.d.siteId!==o.e.Empty?e.d.siteId:null,webId:e.d.webId!==o.e.Empty?e.d.webId:null,uniqueId:e.d.uniqueId!==o.e.Empty?e.d.uniqueId:null,isInternal:i.isInternal(e.d.url,e.d.uniqueId),webUrl:void 0}},function(e){return null}).then(function(e){return e.uniqueId||c?d.t.wrap(e):t.isSharePointUrl(e.url)?i.getFileByUrl(e.url).then(function(t){var n=!!t&&t.UniqueId&&o.e.normalizeLower(t.UniqueId);return n&&(e.uniqueId=n),e}):d.t.wrap(e)})})},t.prototype.generateShortcutsOpenUrl=function(e,t,n,a,i,r){if(a&&i&&r&&-1===n.toLowerCase().indexOf("guestaccess.aspx")){var o="",s="?";if(n){var c=n.indexOf("?");-1!==c&&(s=n.substring(c)+"&")}return o=e+"/"+t+"/ShortcutLink.aspx",o+=s+"siteid="+f.e.encodeURIComponent(a),(o+="&webid="+f.e.encodeURIComponent(i))+"&uniqueid="+f.e.encodeURIComponent(r)}return n},t.prototype.enqueueParseShortcut=function(e,t){var n=this,a=this._itemUrlHelper.getItemUrlParts(e);this.trackPromise(this._shortcutResolverQueue.enqueue(function(){var i=new(n.managed(h.default));return n.getShortcutTargetData({url:a.fullItemUrl,avoidGetFileByUrlCall:!0,parentKey:e}).then(function(a){var r,o=n.generateShortcutsOpenUrl(n._pageContext.webAbsoluteUrl,n._pageContext.layoutsUrl,a.url,a.siteId,a.webId,a.uniqueId),s={key:e,shortcutInfo:{shortcutLinkRewritten:!0},urls:(r={},r[g.t.shortcutTarget]=o,r)};a.uniqueId&&(s.thumbnail=m.previewImageUrl(a,n._pageContext.webAbsoluteUrl,n._pageContext)),i.update([new b.e(e).succeed({item:s})]),i.flush(),n.resources.consume(C.t)&&t&&n.resources.consumeAsync(x).then(function(n){n.updateItemShortcutValues(e,t,a)})}).then(function(){i.dispose()},function(e){return i.dispose(),d.t.wrapError(e)})}))},t.prototype.getFileByUrl=function(e){var t,n=this,a=this._itemUrlHelper.getUrlParts({path:e});if(a.isCrossDomain||a.siteRelation===y.e.sameSite)t=d.t.wrap(e);else{var i=this._apiUrlHelper.contextInfoUrl(a.fullItemUrl);t=this._dataRequestor.getData({url:i,method:"POST",qosName:"GetContextInfo"}).then(function(e){return e.d.GetContextWebInformation.WebFullUrl})}return t.then(function(t){var a=n._apiUrlHelper.build().webByUrl({path:t,webUrl:t}).method("GetFileByUrl",e);return n._dataRequestor.getData({url:a.toString(),qosName:"GetFileByUrl",method:"GET",noRedirect:!0}).then(function(t){return n._parseGetFileResponse(t,e)})})},t.prototype._getCreateShortcutPostBody=function(e){return"[InternetShortcut]\nURL="+e+"\n"},t.prototype._parseGetFileResponse=function(e,t){return{CheckInComment:e.d.CheckInComment,CheckOutType:parseInt(e.d.CheckOutType,10),ContentTag:e.d.ContentTag,CustomizedPageStatus:e.d.CustomizedPageStatus,ETag:e.d.ETag,Exists:!!e.d.Exists,IrmEnabled:!!e.d.IrmEnabled,Length:parseInt(e.d.Length,10),Level:parseInt(e.d.Level,10),LinkingUrl:e.d.LinkingUrl,MajorVersion:parseInt(e.d.MajorVersion,10),MinorVersion:parseInt(e.d.MinorVersion,10),Name:e.d.Name,ServerRelativeUrl:e.d.ServerRelativeUrl,ServerUrl:new p.e(t).authority,TimeCreated:Object(r.t)(e.d.TimeCreated),TimeLastModified:Object(r.t)(e.d.TimeLastModified),Title:e.d.Title,UIVersion:parseInt(e.d.UIVersion,10),UIVersionLabel:e.d.UIVersionLabel,UniqueId:e.d.UniqueId}},t.prototype._getAuthToken=function(e){var t=d.t.resolve(void 0),n=this._itemUrlHelper.getItemUrlParts(e.parentKey);return n&&n.fullWebUrl&&n.isCrossDomain&&(t=this._identityDataSource.getSharePointToken(new p.e(n.fullItemUrl).authority).then(function(e){return e.accessToken}).catch(function(e){c.e.logError(e)})),t},t.prototype._getAuthTokenForSite=function(e){return this._identityDataSource.getSharePointToken(e).then(function(e){return e.accessToken}).catch(function(e){c.e.logError(e)})},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{pageContext:D.i,apiUrlHelper:v.e,itemUrlHelper:y.o,dataRequestorType:S.e,identityDataSource:O.t}),t}(i.n),E=(t.default=w,Object(I.r)("ShortcutLinkDataSource",w))}}]);